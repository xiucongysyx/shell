(window.webpackJsonpMsb=window.webpackJsonpMsb||[]).push([[119],{1184:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n(97),r=n(1116),a=n(96),o=n(1633),c=function(e){return a.createElement(o.a,Object(i.__assign)({},e,{hasDefaultHeightInCollapse:!1,collapsedContentMinHeight:140}))},l=function(e){return a.createElement(o.a,Object(i.__assign)({},e,{hasDefaultHeightInCollapse:!1}))},s=function(){return{entityType:"Acronym",components:{Answer:{MainLine:{Hero:l,Shy:c}}},redux:{selectors:{getResults:r.c,getHeroResult:r.e,getTopCandidates:r.b,getFeedbackSymptom:function(){return"SearchAnswerAcronym"},getExpansion:r.d,getHeader:r.a}}}}},2277:function(e,t,n){
/*!
 * Fuse.js v3.6.1 - Lightweight fuzzy-search (http://fusejs.io)
 * 
 * Copyright (c) 2012-2017 Kirollos Risk (http://kiro.me)
 * All Rights Reserved. Apache Software License 2.0
 * 
 * http://www.apache.org/licenses/LICENSE-2.0
 */
e.exports=function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var a=n(1),o=n(7),c=o.get,l=(o.deepValue,o.isArray),s=function(){function e(t,n){var i=n.location,r=void 0===i?0:i,a=n.distance,o=void 0===a?100:a,l=n.threshold,s=void 0===l?.6:l,u=n.maxPatternLength,d=void 0===u?32:u,b=n.caseSensitive,m=void 0!==b&&b,p=n.tokenSeparator,f=void 0===p?/ +/g:p,g=n.findAllMatches,v=void 0!==g&&g,h=n.minMatchCharLength,O=void 0===h?1:h,j=n.id,E=void 0===j?null:j,x=n.keys,S=void 0===x?[]:x,C=n.shouldSort,y=void 0===C||C,k=n.getFn,w=void 0===k?c:k,N=n.sortFn,_=void 0===N?function(e,t){return e.score-t.score}:N,L=n.tokenize,M=void 0!==L&&L,T=n.matchAllTokens,P=void 0!==T&&T,I=n.includeMatches,F=void 0!==I&&I,A=n.includeScore,R=void 0!==A&&A,B=n.verbose,D=void 0!==B&&B;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options={location:r,distance:o,threshold:s,maxPatternLength:d,isCaseSensitive:m,tokenSeparator:f,findAllMatches:v,minMatchCharLength:O,id:E,keys:S,includeMatches:F,includeScore:R,shouldSort:y,getFn:w,sortFn:_,verbose:D,tokenize:M,matchAllTokens:P},this.setCollection(t),this._processKeys(S)}var t,n;return t=e,(n=[{key:"setCollection",value:function(e){return this.list=e,e}},{key:"_processKeys",value:function(e){if(this._keyWeights={},this._keyNames=[],e.length&&"string"==typeof e[0])for(var t=0,n=e.length;t<n;t+=1){var i=e[t];this._keyWeights[i]=1,this._keyNames.push(i)}else{for(var r=null,a=null,o=0,c=0,l=e.length;c<l;c+=1){var s=e[c];if(!s.hasOwnProperty("name"))throw new Error('Missing "name" property in key object');var u=s.name;if(this._keyNames.push(u),!s.hasOwnProperty("weight"))throw new Error('Missing "weight" property in key object');var d=s.weight;if(d<0||d>1)throw new Error('"weight" property in key must bein the range of [0, 1)');a=null==a?d:Math.max(a,d),r=null==r?d:Math.min(r,d),this._keyWeights[u]=d,o+=d}if(o>1)throw new Error("Total of weights cannot exceed 1")}}},{key:"search",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{limit:!1};this._log('---------\nSearch pattern: "'.concat(e,'"'));var n=this._prepareSearchers(e),i=n.tokenSearchers,r=n.fullSearcher,a=this._search(i,r);return this._computeScore(a),this.options.shouldSort&&this._sort(a),t.limit&&"number"==typeof t.limit&&(a=a.slice(0,t.limit)),this._format(a)}},{key:"_prepareSearchers",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=[];if(this.options.tokenize)for(var n=e.split(this.options.tokenSeparator),i=0,r=n.length;i<r;i+=1)t.push(new a(n[i],this.options));return{tokenSearchers:t,fullSearcher:new a(e,this.options)}}},{key:"_search",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=this.list,i={},r=[];if("string"==typeof n[0]){for(var a=0,o=n.length;a<o;a+=1)this._analyze({key:"",value:n[a],record:a,index:a},{resultMap:i,results:r,tokenSearchers:e,fullSearcher:t});return r}for(var c=0,l=n.length;c<l;c+=1)for(var s=n[c],u=0,d=this._keyNames.length;u<d;u+=1){var b=this._keyNames[u];this._analyze({key:b,value:this.options.getFn(s,b),record:s,index:c},{resultMap:i,results:r,tokenSearchers:e,fullSearcher:t})}return r}},{key:"_analyze",value:function(e,t){var n=this,i=e.key,r=e.arrayIndex,a=void 0===r?-1:r,o=e.value,c=e.record,s=e.index,u=t.tokenSearchers,d=void 0===u?[]:u,b=t.fullSearcher,m=t.resultMap,p=void 0===m?{}:m,f=t.results,g=void 0===f?[]:f;!function e(t,r,a,o){if(null!=r)if("string"==typeof r){var c=!1,s=-1,u=0;n._log("\nKey: ".concat(""===i?"--":i));var m=b.search(r);if(n._log('Full text: "'.concat(r,'", score: ').concat(m.score)),n.options.tokenize){for(var f=r.split(n.options.tokenSeparator),v=f.length,h=[],O=0,j=d.length;O<j;O+=1){var E=d[O];n._log('\nPattern: "'.concat(E.pattern,'"'));for(var x=!1,S=0;S<v;S+=1){var C=f[S],y=E.search(C),k={};y.isMatch?(k[C]=y.score,c=!0,x=!0,h.push(y.score)):(k[C]=1,n.options.matchAllTokens||h.push(1)),n._log('Token: "'.concat(C,'", score: ').concat(k[C]))}x&&(u+=1)}s=h[0];for(var w=h.length,N=1;N<w;N+=1)s+=h[N];s/=w,n._log("Token score average:",s)}var _=m.score;s>-1&&(_=(_+s)/2),n._log("Score average:",_);var L=!n.options.tokenize||!n.options.matchAllTokens||u>=d.length;if(n._log("\nCheck Matches: ".concat(L)),(c||m.isMatch)&&L){var M={key:i,arrayIndex:t,value:r,score:_};n.options.includeMatches&&(M.matchedIndices=m.matchedIndices);var T=p[o];T?T.output.push(M):(p[o]={item:a,output:[M]},g.push(p[o]))}}else if(l(r))for(var P=0,I=r.length;P<I;P+=1)e(P,r[P],a,o)}(a,o,c,s)}},{key:"_computeScore",value:function(e){this._log("\n\nComputing score:\n");for(var t=this._keyWeights,n=!!Object.keys(t).length,i=0,r=e.length;i<r;i+=1){for(var a=e[i],o=a.output,c=o.length,l=1,s=0;s<c;s+=1){var u=o[s],d=u.key,b=n?t[d]:1,m=0===u.score&&t&&t[d]>0?Number.EPSILON:u.score;l*=Math.pow(m,b)}a.score=l,this._log(a)}}},{key:"_sort",value:function(e){this._log("\n\nSorting...."),e.sort(this.options.sortFn)}},{key:"_format",value:function(e){var t=[];if(this.options.verbose){var n=[];this._log("\n\nOutput:\n\n",JSON.stringify(e,(function(e,t){if("object"===i(t)&&null!==t){if(-1!==n.indexOf(t))return;n.push(t)}return t}),2)),n=null}var r=[];this.options.includeMatches&&r.push((function(e,t){var n=e.output;t.matches=[];for(var i=0,r=n.length;i<r;i+=1){var a=n[i];if(0!==a.matchedIndices.length){var o={indices:a.matchedIndices,value:a.value};a.key&&(o.key=a.key),a.hasOwnProperty("arrayIndex")&&a.arrayIndex>-1&&(o.arrayIndex=a.arrayIndex),t.matches.push(o)}}})),this.options.includeScore&&r.push((function(e,t){t.score=e.score}));for(var a=0,o=e.length;a<o;a+=1){var c=e[a];if(this.options.id&&(c.item=this.options.getFn(c.item,this.options.id)[0]),r.length){for(var l={item:c.item},s=0,u=r.length;s<u;s+=1)r[s](c,l);t.push(l)}else t.push(c.item)}return t}},{key:"_log",value:function(){var e;this.options.verbose&&(e=console).log.apply(e,arguments)}}])&&r(t.prototype,n),e}();e.exports=s},function(e,t,n){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var r=n(2),a=n(3),o=n(6),c=function(){function e(t,n){var i=n.location,r=void 0===i?0:i,a=n.distance,c=void 0===a?100:a,l=n.threshold,s=void 0===l?.6:l,u=n.maxPatternLength,d=void 0===u?32:u,b=n.isCaseSensitive,m=void 0!==b&&b,p=n.tokenSeparator,f=void 0===p?/ +/g:p,g=n.findAllMatches,v=void 0!==g&&g,h=n.minMatchCharLength,O=void 0===h?1:h,j=n.includeMatches,E=void 0!==j&&j;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options={location:r,distance:c,threshold:s,maxPatternLength:d,isCaseSensitive:m,tokenSeparator:f,findAllMatches:v,includeMatches:E,minMatchCharLength:O},this.pattern=m?t:t.toLowerCase(),this.pattern.length<=d&&(this.patternAlphabet=o(this.pattern))}var t,n;return t=e,(n=[{key:"search",value:function(e){var t=this.options,n=t.isCaseSensitive,i=t.includeMatches;if(n||(e=e.toLowerCase()),this.pattern===e){var o={isMatch:!0,score:0};return i&&(o.matchedIndices=[[0,e.length-1]]),o}var c=this.options,l=c.maxPatternLength,s=c.tokenSeparator;if(this.pattern.length>l)return r(e,this.pattern,s);var u=this.options,d=u.location,b=u.distance,m=u.threshold,p=u.findAllMatches,f=u.minMatchCharLength;return a(e,this.pattern,this.patternAlphabet,{location:d,distance:b,threshold:m,findAllMatches:p,minMatchCharLength:f,includeMatches:i})}}])&&i(t.prototype,n),e}();e.exports=c},function(e,t){var n=/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g;e.exports=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:/ +/g,r=new RegExp(t.replace(n,"\\$&").replace(i,"|")),a=e.match(r),o=!!a,c=[];if(o)for(var l=0,s=a.length;l<s;l+=1){var u=a[l];c.push([e.indexOf(u),u.length-1])}return{score:o?.5:1,isMatch:o,matchedIndices:c}}},function(e,t,n){var i=n(4),r=n(5);e.exports=function(e,t,n,a){for(var o=a.location,c=void 0===o?0:o,l=a.distance,s=void 0===l?100:l,u=a.threshold,d=void 0===u?.6:u,b=a.findAllMatches,m=void 0!==b&&b,p=a.minMatchCharLength,f=void 0===p?1:p,g=a.includeMatches,v=void 0!==g&&g,h=c,O=e.length,j=d,E=e.indexOf(t,h),x=t.length,S=[],C=0;C<O;C+=1)S[C]=0;if(-1!==E){var y=i(t,{errors:0,currentLocation:E,expectedLocation:h,distance:s});if(j=Math.min(y,j),-1!==(E=e.lastIndexOf(t,h+x))){var k=i(t,{errors:0,currentLocation:E,expectedLocation:h,distance:s});j=Math.min(k,j)}}E=-1;for(var w=[],N=1,_=x+O,L=1<<(x<=31?x-1:30),M=0;M<x;M+=1){for(var T=0,P=_;T<P;)i(t,{errors:M,currentLocation:h+P,expectedLocation:h,distance:s})<=j?T=P:_=P,P=Math.floor((_-T)/2+T);_=P;var I=Math.max(1,h-P+1),F=m?O:Math.min(h+P,O)+x,A=Array(F+2);A[F+1]=(1<<M)-1;for(var R=F;R>=I;R-=1){var B=R-1,D=n[e.charAt(B)];if(D&&(S[B]=1),A[R]=(A[R+1]<<1|1)&D,0!==M&&(A[R]|=(w[R+1]|w[R])<<1|1|w[R+1]),A[R]&L&&(N=i(t,{errors:M,currentLocation:B,expectedLocation:h,distance:s}))<=j){if(j=N,(E=B)<=h)break;I=Math.max(1,2*h-E)}}if(i(t,{errors:M+1,currentLocation:h,expectedLocation:h,distance:s})>j)break;w=A}var H={isMatch:E>=0,score:0===N?.001:N};return v&&(H.matchedIndices=r(S,f)),H}},function(e,t){e.exports=function(e,t){var n=t.errors,i=void 0===n?0:n,r=t.currentLocation,a=void 0===r?0:r,o=t.expectedLocation,c=void 0===o?0:o,l=t.distance,s=void 0===l?100:l,u=i/e.length,d=Math.abs(c-a);return s?u+d/s:d?1:u}},function(e,t){e.exports=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=[],i=-1,r=-1,a=0,o=e.length;a<o;a+=1){var c=e[a];c&&-1===i?i=a:c||-1===i||((r=a-1)-i+1>=t&&n.push([i,r]),i=-1)}return e[a-1]&&a-i>=t&&n.push([i,a-1]),n}},function(e,t){e.exports=function(e){for(var t={},n=e.length,i=0;i<n;i+=1)t[e.charAt(i)]=0;for(var r=0;r<n;r+=1)t[e.charAt(r)]|=1<<n-r-1;return t}},function(e,t){var n=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)},i=function(e){return null==e?"":function(e){if("string"==typeof e)return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}(e)},r=function(e){return"string"==typeof e},a=function(e){return"number"==typeof e};e.exports={get:function(e,t){var o=[];return function e(t,c){if(c){var l=c.indexOf("."),s=c,u=null;-1!==l&&(s=c.slice(0,l),u=c.slice(l+1));var d=t[s];if(null!=d)if(u||!r(d)&&!a(d))if(n(d))for(var b=0,m=d.length;b<m;b+=1)e(d[b],u);else u&&e(d,u);else o.push(i(d))}else o.push(t)}(e,t),o},isArray:n,isString:r,isNum:a,toString:i}}])},2381:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n(96),r=n(778),a=n(1238),o=n(128),c=Object(a.a)((function(e){var t;return Object(o.K)({contentContainer:{width:e,selectors:(t={},t[".".concat("ms-search-friendly-carousel")]={overflow:"visible",padding:"0px 20px"},t)}})})),l=function(e){var t=e.width,n=c(t);return i.createElement("div",{className:n.contentContainer},i.createElement(r.a,{className:"ms-search-friendly-carousel",carouselType:"HalfBleed",scrollAnimationDuration:1e3,renderCarouselContent:function(t){return i.createElement("div",{id:t},e.children)},minScrollDistance:20,scrollAmount:100,scrollArrowTopPosition:4}))}},768:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return o}));function i(){for(var e=r();e&&"LI"!==e.nodeName&&e.parentElement;)e=e.parentElement;return e||void 0}function r(){return document&&document.getElementsByClassName("bw-ScopeItem")&&document.getElementsByClassName("bw-ScopeItem")[0]}function a(){return document&&document.getElementById("bw-Scope_bingatwork_iconDot")}function o(){return document&&document.getElementsByClassName("b_searchboxForm")&&document.getElementsByClassName("b_searchboxForm")[0]}},93:function(e,t,n){"use strict";n.r(t),n.d(t,"init",(function(){return es}));var i=n(321),r=n.n(i),a=n(114),o=n.n(a),c=n(325),l=n(170),s=n.n(l),u=n(177),d=n.n(u),b=n(157),m=n(129),p=n(1488),f=n(96),g=n(312),v=n(1238),h=n(298),O=n(105),j=n(601),E=n(128),x=Object(v.a)((function(e,t){return Object(E.K)({frame:{boxShadow:"0 0 0 1px rgba(0,0,0,.05), 0 2px 3px 0 rgba(0,0,0,.1)",width:"452px",borderRadius:"6px",paddingLeft:"20px",paddingBottom:"20px",paddingTop:t?"18px":"24px",display:"flex",flex:"row"},title:[Object(O.n)(e),j.d,{whiteSpace:"normal",fontWeight:"500",wordWrap:"break-word",fontStyle:"normal",fontSize:"18px",color:e.palette.black,lineHeight:"22px",width:"318px",verticalAlign:"top",marginTop:t?"16px":null,marginBottom:"12px"}],qrcode:{marginLeft:t?"25px":"32px",marginTop:t?"30px":"null",marginRight:"20px"},body:[Object(O.n)(e),j.d,{whiteSpace:"normal",fontFamily:O.w,marginTop:"12px",fontWeight:"400",wordWrap:"break-word",fontStyle:"normal",fontSize:"13px",color:e.palette.neutralPrimary,lineHeight:"20px",width:"318px"}],greeting:[Object(O.n)(e),j.d,{whiteSpace:"normal",fontFamily:O.w,fontWeight:"500",fontStyle:"normal",fontSize:"14px",color:e.palette.neutralDark,lineHeight:"20px",width:"100%",marginBottom:"16px"}],boldText:{fontWeight:"bold",color:h.i},container:{marginBottom:"60px"},learnMore:{fontStyle:"normal",fontWeight:"400",fontSize:"13px",lineHeight:"20px",color:e.palette.neutralPrimary},dismissNotification:{marginTop:"5px",textAlign:"right",selectors:{"&:hover":{cursor:"pointer"}}}})})),S=function(e){var t=e.onShown,n=e.useExtendedGreeting,i=e.onCloseClick,r=e.onEngagementClick,a=Object(p.a)(),o=x(a,n),c=Object(g.d)("SerpMobilePromotion",n),l=f.createElement("div",{className:o.greeting},Object(b.Fb)()),s=f.createElement("span",{className:o.title},n&&Object(b.Hb)(),!n&&Object(b.Gb)());return f.useEffect(t,[]),f.createElement(f.Fragment,null,f.createElement("div",{className:o.container},f.createElement("div",{className:o.frame},f.createElement("div",null,n&&l,f.createElement("span",{className:o.title},s),f.createElement("div",{className:o.body},f.createElement("span",{className:o.boldText},Object(b.Db)()),Object(b.Eb)(),f.createElement("a",{className:o.learnMore,href:"https://spdocs.blob.core.windows.net/search/06-Be-productive-from-anywhere.pdf",target:"_blank",onClick:function(){r()}},Object(b.S)()))),f.createElement("div",{className:o.qrcode},f.createElement("img",{src:c,alt:Object(b.R)()}))),i&&f.createElement("label",{role:"button",onClick:i,onKeyPress:function(e){Object(m.o)(e,i)},className:o.dismissNotification},Object(b.o)())))},C=Object(v.a)((function(e){return Object(E.K)({frame:{boxShadow:"0 0 0 1px rgba(0,0,0,.05), 0 2px 3px 0 rgba(0,0,0,.1)",borderRadius:"6px",paddingBottom:"20px"},headerContent:{display:"inline-flex",fontFamily:O.w,fontStyle:"normal",fontSize:"18px",fontWeight:"500",width:"257px",paddingBottom:"16px",justifyContent:"space-between",paddingTop:"24px",paddingLeft:"20px",paddingRight:"20px"},title:[Object(O.q)(e),j.d,{verticalAlign:"top",lineHeight:"24px",display:"inline-block",color:e.palette.black}],line:{borderBottom:"1px solid ".concat(e.palette.neutralLight)},body:[Object(O.n)(e),j.d,{fontFamily:O.w,color:e.palette.neutralPrimary,lineHeight:"18px",paddingBottom:"10px",paddingLeft:"20px",paddingRight:"20px"}],dismissNotification:{marginTop:"5px",textAlign:"right",selectors:{"&:hover":{cursor:"pointer"}}},header:{height:"44px",paddingLeft:"20px",paddingRight:"20px"},headerText:{fontFamily:O.w,color:e.palette.neutralDark,lineHeight:"20px",fontStyle:"normal",fontSize:"14px",fontWeight:"500",paddingTop:"13px",paddingBottom:"11px",display:"inline-block"},commonButton:[Object(O.n)(e),{display:"block",border:"0",backgroundColor:e.palette.blueMid,color:e.palette.white,height:"32px",minWidth:"161px",borderRadius:"2px",padding:"8px 20px 8px 20px",marginLeft:"20px",textAlign:"center",lineHeight:"16px",selectors:{"&:hover":{cursor:"pointer"}}}]})})),y=function(e){var t=e.onShown,n=e.onCloseClick,i=e.onEngagementClick,r=e.url,a=e.treatmentVariation,o=e.notificationKind,c=Object(p.a)(),l=C(c),s=Object(b.Cb)(o,a),u=f.createElement("button",{className:l.commonButton,role:"button",onClick:function(){i(),window.open(r)},"aria-label":s},s);return f.useEffect(t,[]),f.createElement(f.Fragment,null,f.createElement("div",{className:l.frame},f.createElement("div",{className:l.header},f.createElement("div",{className:l.headerText},Object(b.m)())),f.createElement("div",null,f.createElement("div",{className:l.line})),f.createElement("div",{className:l.headerContent},f.createElement("div",{className:l.title},Object(b.Kb)(o,void 0,void 0,a))),f.createElement("div",{className:l.body},Object(b.Ib)(o,void 0,void 0,void 0,void 0,void 0,a)),r&&u),n&&f.createElement("label",{role:"button",onClick:n,onKeyPress:function(e){Object(m.o)(e,n)},className:l.dismissNotification},Object(b.o)()))},k=n(127),w=n(110),N=n(111),_=n(107),L=n(893),M=n(272),T=n(102),P=n(223),I=n(139),F=n(197),A=n(483),R=n(559),B=n(214),D=n(236),H=function(){var e=Object(T.useSelector)(P.r),t=Object(B.a)("DiscoverabilityPill"),n=t.hasNotificationKind,i=t.notificationConfig,r=Object(B.a)("DiscoverabilityPillSubsequent"),a=r.hasNotificationKind,o=r.notificationConfig,c=Object(B.a)("DiscoverabilityPillFre"),l=c.hasNotificationKind,s=c.notificationConfig,u=Object(D.a)("DiscoverabilityPill","DiscoverabilityPillContainer").logDismissClick;return{isEnabled:l||n||a,activeNotificationKind:l?"DiscoverabilityPillFre":n?"DiscoverabilityPill":"DiscoverabilityPillSubsequent",activeNotificationConfig:l?s:n?i:o,onFirstDismiss:function(){n&&e&&u()}}},W=Object(v.a)((function(){return Object(E.K)({notificationListItem:["ms-search-mainline-notification",{display:"flex",flexDirection:"column"}]})})),z=n(125),q=n(252),K=n(1466),Q=n(1468),U=n(630),V=n(441),G=n(112),J=n(152),Y=n(181),$=n(621),X=n(259),Z=n(473),ee=n(609),te=n(1568),ne=n(1136),ie=n(1038),re=n(178),ae=n(712),oe=n(1650),ce=n(194),le=n(131),se=n(2599),ue=n(1416),de=n(119),be=n(521),me=Object(ue.b)((function(e){return Object(E.K)({container:[be.a,Object(de.o)(e),{height:"240px",display:"flex",flexDirection:"column",justifyContent:"space-evenly"}],longGhostText:{width:"75%",margin:"0px 19px"},shortGhostText:{width:"25%",margin:"0px 19px"}})})),pe=n(391),fe=Object(se.a)((function(e){var t=me(e.theme),n=f.createElement(pe.a,{lineClassName:t.shortGhostText,numLines:1});return f.createElement("div",{className:t.container},f.createElement("div",null,f.createElement(pe.a,{lineClassName:t.longGhostText,numLines:1}),n),f.createElement(pe.a,{lineClassName:t.longGhostText,numLines:2}),n)})),ge=n(548),ve=n(470),he=n(246),Oe=Object(v.a)((function(e){return Object(E.K)({card:{padding:"28px 18px 8px 18px"},lastModifiedBy:{fontSize:"13px",fontWeight:"400",lineHeight:"20px",color:e.palette.black},lastModifiedName:{fontSize:"14px"},lastModifiedAt:{fontWeight:"400",fontSize:"11px",lineHeight:"13px",color:e.palette.neutralPrimary},file:{display:"flex",height:"88px",justifyContent:"flex-start",alignItems:"center",padding:"12px",backgroundColor:e.palette.white,boxSizing:"border-box",border:"1px solid #DDDDDD",borderRadius:"6px",cursor:"pointer",userSelect:"text",marginTop:"19px",selectors:{":hover":[{boxShadow:Object(ve.e)(e),textDecoration:"none"}]}},iconContainer:{marginRight:"12px",background:e.palette.neutralLighterAlt,height:"64px",width:"64px",borderRadius:"8px"},iconContent:{margin:"12px"},fileContent:[j.f,{display:"flex",flexDirection:"column",justifyContent:"space-around",gap:"4px"}],fileName:[j.f,{fontSize:"14px",color:e.palette.neutralDark,lineHeight:"20px"}],fileUrl:[j.f,{fontSize:"14px",lineHeight:"20px",color:e.palette.green}],footer:{padding:"14px 0px"},link:[Object(he.v)(e),{marginTop:"14px"}]})})),je=function(e){var t=e.onEngagementClick,n=e.file,i=e.link,r=e.onFooterClick,a=Object(p.a)(),o=Oe(a),c=n.fileName,l=n.lastModifiedByFullName,s=n.lastModifiedTime,u=n.url,d=n.extension,m=n.fileType,g=l?f.createElement(f.Fragment,null,f.createElement("b",null,l),Object(b.F)()):f.createElement(f.Fragment,null,Object(b.q)());return f.createElement("div",{className:o.card},f.createElement("div",{className:o.lastModifiedBy},g),f.createElement("div",{className:o.lastModifiedAt},s),f.createElement("a",{className:o.file,href:u,onClick:function(){t()}},f.createElement("div",{className:o.iconContainer},f.createElement(ge.a,{iconSize:40,fileExtension:d,fileType:m,className:o.iconContent})),f.createElement("div",{className:o.fileContent},f.createElement("div",{className:o.fileName},c),u&&f.createElement("div",{className:o.fileUrl},u))),f.createElement("div",{className:o.footer},f.createElement("a",{className:o.link,onClick:function(){null==r||r()},href:i},Object(b.yb)())))},Ee=n(383),xe=n(597),Se=n(1130),Ce=n(894),ye=n(142),ke=Object(v.a)((function(e,t,n){var i;return Object(E.K)({container:{background:e.palette.white,borderRadius:ve.a,boxShadow:"0px 0px 0px 1px rgba(0, 0, 0, 0.05), 0px 2px 3px rgba(0, 0, 0, 0.1)"},frame:{height:"4px",borderTopLeftRadius:ve.a,borderTopRightRadius:ve.a,background:t?n:e.palette.blueMid,selectors:(i={},i[E.h]={"-ms-high-contrast-adjust":"none","forced-color-adjust":"none"},i)}})})),we=function(e){var t=e.notificationKind,n=e.useAdminTheme,i=e.navBarColor,r=e.onExampleClick,a=e.onFooterClick,o=Object(p.a)(),c=Object(k.a)(),l=Object(w.b)(),s=Object(Se.a)(),u=Object(T.useDispatch)(),d=null==s?void 0:s.items,m=null==s?void 0:s.hasFetched,g=Object(w.x)().buildBingWorkVerticalUrl,v=ke(o,n,i),h=f.useState(!1),O=h[0],j=h[1],E=f.createElement(fe,null),x=g&&g({query:Object(b.T)()||"my files"},void 0,Fe),S=function(){Object(Ce.c)(c,l,"RecentFiles",t.toString(),t),null==r||r()},C=m?Object(le.a)(d)?null:Object(z.a)(Object(ce.a)(d,1),(function(e,t){return f.createElement(f.Fragment,{key:t},f.createElement(je,{onEngagementClick:S,onFooterClick:a,file:Object(Ee.a)(e),link:x}))})):E;return f.useEffect((function(){m&&C&&(C?O||(Object(ye.k)(c,l,"RecentFiles",t.toString(),t),j(!0),u(Object(xe.b)({successExampleType:"RecentFiles"}))):u(Object(xe.a)({disabledExampleType:"RecentFiles"})))}),[m,C]),C?f.createElement("div",{className:v.container},f.createElement("div",{className:v.frame}),C):null},Ne=n(150),_e=Object(v.a)((function(e,t,n,i,r,a,o){var c,l,s,u;return Object(E.K)({mainContainer:{display:"flex",flexDirection:"column",fontFamily:i?void 0:e.fonts.mediumPlus.fontFamily,fontWeight:"400",maxWidth:"440px"},headerRow:{display:"flex",flexDirection:"row",backgroundColor:t?n:e.palette.black,borderTopLeftRadius:ve.a,borderTopRightRadius:ve.a,paddingLeft:"20px",selectors:(c={},c[E.h]={"-ms-high-contrast-adjust":"none","forced-color-adjust":"none"},c)},masthead:{position:"relative",display:"flex",flexDirection:"column",overflow:"hidden",height:"auto",paddingTop:o?"".concat(o,"px"):"auto",paddingBottom:o?"".concat(o,"px"):"auto",color:e.palette.white,fontSize:"16px",lineHeight:"24px",fontWeight:"700",selectors:(l={},l[".".concat(V.a)]={verticalAlign:"top",minHeight:"".concat(V.b,"px"),maxWidth:"".concat(Ne.F,"px"),width:r?"100%":void 0,minWidth:r?"120px":void 0},l)},headerRowRight:{marginLeft:"auto",position:"relative",padding:a?"auto":"13px 19px 0px 0px",selectors:(s={},s[E.h]={"-ms-high-contrast-adjust":"none","forced-color-adjust":"auto"},s)},profilePhoto:{position:a?"absolute":"static",border:a?"4px solid ".concat(t?n:e.palette.black):"none",borderRadius:a?"72px":"auto",marginTop:a?"-10px":"auto",marginLeft:a?"-40px":"auto",backgroundColor:a?t?n:e.palette.black:void 0},subtitleContainer:{padding:"28px 24px 20px 24px"},subtitle:[Object(j.e)(2),{overflow:"hidden",fontSize:"16px",lineHeight:"22px",color:e.palette.neutralDark}],title:[Object(j.e)(3),{overflow:"hidden",fontSize:"24px",lineHeight:"28px",color:e.palette.black,paddingBottom:"8px"}],content:{background:"linear-gradient(122deg, ".concat(t&&n?n+"05":"rgba(229, 235, 255, 0.03)"," 0%, ").concat(t&&n?n+"0d":"rgba(226, 238, 255, 1)"," 99%),\n          linear-gradient(0deg, ").concat(e.palette.white,", ").concat(e.palette.white,")"),boxShadow:"0px 0px 0px 1px rgba(0, 0, 0, 0.05), 0px 2px 3px rgba(0, 0, 0, 0.1)",borderRadius:"0px 0px 6px 6px",paddingBottom:"24px"},privacyContent:{padding:"0px 24px 8px 4px",fontSize:"13px",selectors:(u={},u["#".concat(U.a)]={backgroundColor:"inherit"},u)},fileCard:{padding:"0px 24px 8px 24px"},peopleCard:{padding:"8px 24px 8px 24px"},button:{display:"flex",justifyContent:"center",padding:"0px 24px"},seeMoreButton:[Object(O.n)(e),j.f,{marginTop:"16px",padding:"10px 21px 10px 18px",border:"0",backgroundColor:t?n:e.palette.blueMid,color:e.palette.white,height:"36px",borderRadius:"24px",textAlign:"center",lineHeight:"16px",selectors:{"&:hover":{cursor:"pointer"}}}],seeMoreChevron:{marginLeft:"12px"},dismissNotification:{marginTop:"5px",paddingRight:"16px",textAlign:"right",fontSize:"12px",lineHeight:"15px",color:e.palette.neutralPrimary,selectors:{"&:hover":{cursor:"pointer"}}}})})),Le=n(1643),Me=["RecentFiles","RecentPeople"],Te=function(e){var t=e.onShown,n=e.onCloseClick,i=e.onEngagementClick,r=e.headerHeight,a=Object(p.a)(),o=Object(k.a)(),c=Object(w.b)(),l=Object(J.d)(),s=Object(T.useSelector)(_.M),u=Object(G.a)(),d=Object(Y.b)(),g=Object(Y.e)(),v=Object(J.g)(),h=Object(G.e)(v),O=Object(X.a)(),j=Object(X.b)(),E=f.useState(!1),x=E[0],S=E[1],C=Object(X.c)(),y=Object(w.x)().buildBingWorkVerticalUrl,N=Object(T.useSelector)(P.z),L=Object(T.useSelector)(P.l),M=r?(r-V.b)/2:void 0,I=_e(a,s,d,u,s&&u&&h,N,M),F=Object(te.a)(),A=F.activeExampleTypes,R=F.pendingExampleTypes,B=Object(K.a)(A,Me),D=Object(q.a)(B,Me)||0===Object(K.a)(R,Me).length,H=Object(Q.a)(Me,B);Object(ne.a)(H,"SerpDormantChurnContainer",D);var W=Object(z.a)(B,(function(e){return{notificationFeatureId:new ie.a(e,"ExampleQuery"),engagementLinkCount:1,dismissLinkCount:0,secondaryClickTypes:"RecentFiles"===e?["SeeMore"]:void 0}})),ce=Object($.a)({containerProps:{containerName:"SerpDormantChurnContainer",dismissLinkCount:0,engagementLinkCount:0},cards:W},!0),le=function(e){i(),ce.logChildEngagementClick(new ie.a(e,"ExampleQuery"),0)};f.useEffect((function(){D&&!x&&(ce.logImpression(),S(!0))}),[D,x,ce]);var se=O&&C&&f.createElement(Z.a,{fullName:O,photoId:C,size:N?ae.c.size72:ae.c.size24}),ue=Object(b.Ib)("SerpDormantChurn"),de=Object(b.Kb)("SerpDormantChurn",void 0,void 0,void 0,void 0,j),be=y&&y({query:1===L?Object(b.U)()||"my profile":""},void 0,Fe),me=Object(b.Cb)("SerpDormantChurn",L);return f.useEffect(t,[]),f.createElement("div",{className:I.mainContainer},f.createElement("div",{className:I.headerRow},f.createElement("div",{className:I.masthead},f.createElement(ee.a,{borderBottom:M,tenantLogoSrc:v,tenantDisplayName:l,textIconColor:g,maxLines:3})),se&&f.createElement("div",{className:I.headerRowRight},f.createElement("div",{className:I.profilePhoto},se))),f.createElement("div",{className:I.content},f.createElement("div",{className:I.subtitleContainer},f.createElement("div",{className:I.title},de),f.createElement("div",{className:I.subtitle},ue)),f.createElement("div",{className:I.privacyContent},f.createElement(U.b,{tenantName:l,onClickLogger:function(){Object(re.o)(o,"Learn_More_Click",{clientSize:c,eventScope:"Page"})},isEduEnabled:!1,isLeftAligned:!1})),f.createElement("div",{className:I.fileCard},f.createElement(we,{notificationKind:"SerpDormantChurn",useAdminTheme:s,navBarColor:d,onExampleClick:function(){return le("RecentFiles")},onFooterClick:function(){i(),ce.logChildSecondaryClick(new ie.a("RecentFiles","ExampleQuery"),"SeeMore")}})),f.createElement("div",{className:I.peopleCard,id:"b_bfb_NotificationPeopleCard"},f.createElement(Le.a,{notificationKind:"SerpDormantChurn",maxItems:4,useAdminTheme:s,navBarColor:d,onExampleClick:function(){return le("RecentPeople")}})),f.createElement("div",{className:I.button},f.createElement("button",{className:I.seeMoreButton,role:"button",onClick:function(){i(),window.open(be)},"aria-label":me},me,f.createElement(oe.a,{className:I.seeMoreChevron,iconName:"chevronright"})))),n&&f.createElement("label",{role:"button",onClick:n,onKeyPress:function(e){Object(m.o)(e,n)},className:I.dismissNotification},Object(b.o)()))},Pe=function(e,t,n,i){return new(n||(n=o.a))((function(r,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function c(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,c)}l((i=i.apply(e,t||[])).next())}))},Ie=function(e,t){var n,i,r,a,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof s.a&&(a[d.a]=function(){return this}),a;function c(c){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(o=0)),o;)try{if(n=1,i&&(r=2&c[0]?i.return:c[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,c[1])).done)return r;switch(i=0,r&&(c=[2&c[0],r.value]),c[0]){case 0:case 1:r=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,i=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!r||c[1]>r[0]&&c[1]<r[3])){o.label=c[1];break}if(6===c[0]&&o.label<r[1]){o.label=r[1],r=c;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(c);break}r[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(e){c=[6,e],i=0}finally{n=r=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}},Fe="MSBCRN",Ae=["MainlineFirstRun","NoConfident","DiscoverabilityPill","DiscoverabilityPillSubsequent"],Re=["SerpMobilePromotion","MessageSearch","SerpNonMsbMessage","SerpDormantChurn","AadMsbUpsell"],Be=function(e){var t,n,i,r=e.onHideContainer,a=e.isShownContainer,o=Object(B.a)().hasFetchedNotification,c=Object(k.a)(),l=Object(w.b)(),s=Object(w.x)().buildBingWorkVerticalUrl,u=Object(T.useSelector)(_.M),d=(t=Ae,n=Object(A.a)(),i=Object(T.useSelector)((function(e){return Object(R.e)(e,t)})),Object(T.useSelector)((function(e){return Object(F.a)(i,(function(t){return Object(I.a)(Re,t)&&Object(P.A)(e,t,n)}))}))),m=Object(N.N)(),p=Object(T.useSelector)(P.h),g=Object(T.useSelector)(P.y),v=Object(N.n)(),h=u?48:60,O=W(),j=f.useState(!1),E=j[0],x=j[1],C=f.useState(!1),H=C[0],z=C[1],q=d.length>0?Math.floor(Math.random()*d.length):-1,K=f.useState(q),Q=K[0],U=K[1],V=p||(v&&Q>=0?d[Q]:void 0),G=Object(D.a)(V||"None","MainlineRightRailNotificationContainer",void 0,!0),J=G.logImpression,Y=G.logDismissClick,$=G.logEngagementClick,X=Object(B.a)(V).notificationConfig,Z=Object(T.useSelector)(P.a);if(f.useEffect((function(){Q<0&&q>=0&&U(q)}),[Q,q]),f.useEffect((function(){o&&z(!0)}),[o]),f.useEffect((function(){V||!H&&v||r()}),[H]),V&&!E){var ee=function(){$()},te=function(){x(!0),r(),Y()},ne=function(){return Pe(void 0,void 0,void 0,(function(){return Ie(this,(function(e){switch(e.label){case 0:return X&&Object(M.b)(c,X,"Impression"),[4,a()];case 1:return e.sent()&&J(),[2]}}))}))},ie=null;switch(V){case"SerpMobilePromotion":ie=f.createElement(S,{onShown:ne,useExtendedGreeting:g,onCloseClick:te,onEngagementClick:function(){Object(L.a)(c,l,"LearnMore_En_Click",V,"None")}});break;case"MessageSearch":case"SerpNonMsbMessage":var re=s&&s({query:"*"},m?"Message":"Conversation",void 0,m?"conversations":void 0);ie=f.createElement(y,{onShown:ne,onCloseClick:te,onEngagementClick:ee,url:re,notificationKind:V});break;case"AadMsbUpsell":var ae=s&&s({query:Object(b.U)()},"Work",2===Z?"MSBCR2":"MSBCR1",void 0);ie=f.createElement(y,{onShown:ne,onCloseClick:te,onEngagementClick:ee,url:ae,treatmentVariation:Z,notificationKind:V});break;case"SerpDormantChurn":ie=f.createElement(Te,{onShown:ne,onCloseClick:te,onEngagementClick:ee,headerHeight:h});break;default:ie=null}return ie?f.createElement("div",{className:O.notificationListItem,key:V},ie):null}return null},De=n(199),He=n(2096),We=n(1411),ze=function(){return f.createElement(He.a,null,f.createElement(De.a,{codeLocation:"MainlineRightRailContainer.Bing"},f.createElement(Be,{onHideContainer:We.d,isShownContainer:We.e})))},qe=Object(v.a)((function(e){return Object(E.K)({title:{margin:e?"8px 16px 8px 16px":"20px 0px 12px 24px",fontSize:e?"13px":"16px",lineHeight:e?"":"22px",color:e?"white":"#666666",fontWeight:e?"400":"500"},body:{padding:"0px 24px 20px 24px",fontSize:"14px",lineHeight:"20px",color:e?"white":"#666666"}})})),Ke=function(e){var t=e.title,n=e.body,i=e.isHoverStyle,r=qe(i);return f.createElement("div",null,(null==t?void 0:t.length)>0&&f.createElement("div",{className:r.title}," ",t," "),(null==n?void 0:n.length)>0&&f.createElement("div",{className:r.body}," ",n," "))},Qe=function(e){var t=e.isLowConfidenceQuery,n=e.isEdu,i=t?n?Object(b.wb)():Object(b.vb)():n?Object(b.ub)():Object(b.tb)(),r=t?n?Object(b.sb)():Object(b.rb)():n?Object(b.qb)():Object(b.pb)();return f.createElement(Ke,{title:i,body:r})},Ue=n(151),Ve=Object(v.a)((function(){return Object(E.K)({cancelButton:[Ue.c,{position:"absolute",right:"16px",top:"16px",zIndex:"10",selectors:{"&:hover":{cursor:"pointer"}}}]})})),Ge=function(e){var t=e.onCloseClick,n=Ve();return f.createElement(oe.a,{className:n.cancelButton,iconName:"cancel",role:"button",onClick:t,onKeyPress:function(e){Object(m.o)(e,t)},tabIndex:0})},Je=Object(v.a)((function(e,t,n,i,r,a){return Object(E.K)({bubbleContainer:{position:"absolute",maxWidth:"364px",width:null!=i?i:"364px",height:null!=n?n:"114px",top:e?"".concat(window.pageYOffset+e.bottom+1+(a||0),"px"):"200px",left:e?"".concat(window.pageXOffset+e.left+7,"px"):"200px",filter:"drop-shadow(0px 4.8px 14.4px rgba(0, 0, 0, 0.1)) drop-shadow(0px 25.6px 57.6px rgba(0, 0, 0, 0.13))",backgroundColor:null!=r?r:"white",borderRadius:"6px",zIndex:"100"},bubble:{overflow:"hidden",textAlign:"left",borderRadius:"6px",backgroundColor:null!=r?r:"white"},bubbleArrow:["Top"===t?{margin:0,top:"-8px",left:"11px"}:"Left"===t?{margin:"auto 0",top:"calc(50% - 8px)",left:"-8px"}:{margin:"auto 0",top:"calc(50% - 8px)",right:"-8px"},{position:"absolute",transform:"rotate(-45deg)",width:"16px",height:"16px",backgroundColor:null!=r?r:"white",zIndex:"-1",filter:"drop-shadow(0px 4.8px 14.4px rgba(0, 0, 0, 0.1)) drop-shadow(0px 25.6px 57.6px rgba(0, 0, 0, 0.13))"}]})})),Ye=function(e){var t=f.useState(!1),n=t[0],i=t[1],r=e.arrowPosition,a=e.hideCloseButton,o=e.referenceElement,c=e.onDismissClick,l=e.bubbleHeight,s=e.bubbleWidth,u=e.backgroundColor,d=e.offsetTop,b=null==o?void 0:o.getBoundingClientRect(),m=Je(b,r,l,s,u,d),p=!a&&f.createElement(Ge,{onCloseClick:function(){i(!0),c()}});return n?f.createElement(f.Fragment,null):f.createElement("div",{className:m.bubbleContainer,"data-priority":"2"},f.createElement("div",{className:m.bubbleArrow}),f.createElement("div",{className:m.bubble},p,e.children))},$e=n(768),Xe=n(952),Ze=Object(v.a)((function(e){return Object(E.K)({text:{margin:"20px 24px 20px 24px",fontSize:"16px",lineHeight:"22px",color:e.palette.neutralPrimary,fontWeight:"500"}})})),et=function(e){var t=e.tenantDisplayName,n=e.tenantFriendlyName,i=n||t,r=Object(b.ob)({tenantName:i}),a=Object(p.a)(),o=Ze(a);return f.createElement("div",null,(null==r?void 0:r.length)>0&&f.createElement("div",{className:o.text}," ",r," "))},tt=function(){var e=Object(J.d)(),t=Object(J.e)(),n=Object($e.c)(),i=f.useState(!1),r=i[0],a=i[1];return null==n||n.addEventListener("mouseenter",(function(){a(!0)})),null==n||n.addEventListener("mouseleave",(function(){a(!1)})),r?f.createElement(Ye,{referenceElement:at(),offsetTop:document&&document.getElementById("b_sydHeadBg")&&document.getElementById("b_sydHeadBg")||void 0?-112:0,arrowPosition:"Top",bubbleHeight:"0",bubbleWidth:"undefined",hideCloseButton:!0,onDismissClick:function(){}},f.createElement(et,{tenantDisplayName:e,tenantFriendlyName:t})):null},nt=function(e){var t=e.isLowConfidenceQuery,n=e.isEdu,i=t?n?Object(b.wb)():Object(b.vb)():n?Object(b.ub)():Object(b.tb)();return f.createElement(Ke,{title:i,body:"",isHoverStyle:!0})},it=function(){var e=Object(k.a)(),t=Object($e.c)(),n=Number(null===localStorage||void 0===localStorage?void 0:localStorage.getItem("ScopeTabOverlayHoverImpressionCount")),i=f.useState(!1),r=i[0],a=i[1],o=f.useState(n<=3),c=o[0],l=o[1],s=Object(D.a)("ScopeTabOverlayHover","ScopeTabToolTipContainer",void 0,!0,!1).logImpression,u={notificationKind:"ScopeTabOverlayHover",notificationCampaign:"None"},d=function(){Object(M.b)(e,u,"Impression"),s(),localStorage.setItem("ScopeTabOverlayHoverImpressionCount",(n+1).toString()),m(),l(!1),a(!1)},b=function(){a(!0)},m=function(){null==t||t.removeEventListener("mouseenter",b),null==t||t.removeEventListener("mouseleave",d)},p=Object(N.t)();return f.useEffect((function(){c?(null==t||t.addEventListener("mouseenter",b),null==t||t.addEventListener("mouseleave",d),l(!1)):m()}),[c]),r?f.createElement(Ye,{referenceElement:at(),bubbleHeight:"36px",bubbleWidth:"190px",arrowPosition:"Top",hideCloseButton:!0,backgroundColor:"#666666",onDismissClick:function(){}},f.createElement(nt,{isLowConfidenceQuery:!1,isEdu:p})):null},rt=function(){var e=f.useState(!1),t=e[0],n=e[1],i=f.useState(!1),r=i[0],a=i[1],o=Object(k.a)(),c=Object(B.a)("ScopeTab"),l=c.hasNotificationKind,s=c.notificationConfig,u=Object(B.a)("WorkScopeDotChurn"),d=u.hasNotificationKind,b=u.notificationConfig,m=Object(B.a)("ScopeTabOverlay"),p=m.hasNotificationKind,g=m.notificationConfig,v=Object(B.a)("ScopeTabFriendlyName").hasNotificationKind,h=Object(A.a)(),O=Object(A.b)(),j=!h&&!O,E=Object(T.useSelector)(P.x),x=Object(T.useSelector)(P.C),S=Object(T.useSelector)(P.D),C=Object(T.useSelector)(P.E),y=Object(T.useSelector)(P.G),w=d&&x?"WorkScopeDotChurn":"ScopeTab",_="WorkScopeDotChurn"===w?b:s,L=Object(D.a)(w,"ScopeTabNotificationContainer",void 0,!0),I=L.logImpression,F=L.logEngagementClick,R=Object(D.a)("ScopeTabOverlay","ScopeTabNotificationContainer",void 0,!0),H=R.logImpression,W=R.logEngagementClick,z=R.logDismissClick,q=Object(D.a)("ScopeTabFriendlyName","ScopeTabNotificationContainer",void 0,!0),K=q.logImpression,Q=q.logEngagementClick,U=Object($e.c)(),V=Object($e.b)(),G=V&&!Object(Xe.c)(V),J=U&&V&&(d&&x||l&&!(E&&h)),Y=U&&(G||J)&&(j||!y)&&p,$=U&&C&&v&&!h,X=function(){F(!0)},Z=function(){W(!0)},ee=function(){Q()},te=function e(){K(),null==U||U.removeEventListener("mouseenter",e)},ne=Object(N.t)();return f.useEffect((function(){J&&(Object(Xe.d)(V),U.addEventListener("click",X),t||(_&&Object(M.b)(o,_,"Impression"),I(),n(!0)))}),[U,J,t]),f.useEffect((function(){Y&&(U.addEventListener("click",Z),r||(g&&Object(M.b)(o,g,"Impression"),H(),a(!0)))}),[U,Y,r]),f.useEffect((function(){$&&(U.addEventListener("click",ee),U.addEventListener("mouseenter",te))}),[U,$]),Y?f.createElement(f.Fragment,null,f.createElement(Ye,{referenceElement:at(),arrowPosition:"Top",onDismissClick:z},f.createElement(Qe,{isLowConfidenceQuery:h,isEdu:ne}))):S&&(G||J)?f.createElement(it,null):$?f.createElement(tt,null):null};function at(){return document&&document.getElementById("b-scopeListItem-bingatwork")&&document.getElementById("b-scopeListItem-bingatwork")||void 0}var ot=n(2863),ct=window.BingAtWork.Mainline;window.BingAtWork.Ribbon;function lt(e,t){ct&&ct.showOrHide(!0,e,ct.hideLoadingState,!1,t)}function st(e,t,n){ct&&ct.showOrHide(!1,e,ct.hideLoadingState,null==t||t,n)}function ut(){ct&&ct.hideLcgLoadingState()}var dt=n(881),bt=n(271),mt=n(310),pt=n(144),ft=n(1442),gt=n(767),vt=n(1407),ht=n(2537),Ot=n(600),jt=n(415),Et=n(122),xt=n(146),St=n(253),Ct=n(241),yt=["EmployeeOffer"],kt={EmployeeOffer:3},wt=Object(v.a)((function(e,t,n,i,r,a){if(e&&!t)return{shownDomainResultsCount:[]};var o,c=i&&r?3:2,l=Object(ce.a)(i&&i.candidates,c);if(i){var s=Object(xt.a)(n,(function(e){return e.domain===i.domain})),u=Mt(i.domain,null==s?void 0:s.resultsCount);c=r&&!u?3:2,l=Object(ce.a)(l,u?0:c);var d=u?0:Object(St.a)(l);if(s&&s.resultsCount&&s.resultsCount>d&&!Tt(s.domain,a)){var b=Object(ce.a)(Object(F.a)(n,(function(e){return e.domain!==i.domain})),c-1);o=u?[s].concat(b):[s]}else o=Object(ce.a)(Object(F.a)(n,(function(e){return e.domain!==i.domain})),c-d)}else o=Object(ce.a)(n,c);return{shownCandidates:i&&{domain:i.domain,candidates:l},shownDomainResultsCount:o}})),Nt=Object(v.a)((function(e,t){return!Object(le.a)(e&&e.candidates)||Object(Ct.a)(t,(function(e){return!!e.resultsCount&&e.resultsCount>0}))})),_t=Object(v.a)((function(e){return!!e&&Object(I.a)(yt,e)})),Lt=Object(v.a)((function(e){return _t(e)?2:1})),Mt=Object(v.a)((function(e,t){var n=kt[e];return!(!n||!t)&&t<=n}));function Tt(e,t){return"Acronym"===e||!!t&&"Bookmark"===e}var Pt=n(158),It=n(585),Ft=n(226),At=n(257),Rt=function(){var e=Object(w.b)(),t=Object(k.a)(),n=f.useState(Object(ht.d)())[0],i=Object(gt.a)(),r=Object(At.a)(i),a=Object(Ot.a)(),o=Object(A.b)(),c=Object(A.a)(),l=Object(T.useSelector)((function(e){return Object(Et.e)(e)})),s=Object(jt.a)({domain:l,isHero:!1}),u=Lt(l);return f.useEffect((function(){var d;if("EmployeeOffer"===l&&Object(le.a)(r)&&!Object(le.a)(i)){if(o){var b=Object(ce.a)(i,u);Object(z.a)(b,(function(n,i){Object(ye.p)(t,l,!0,e,i,n.queryType)})),i&&(null==i?void 0:i.length)>u&&Object(ye.p)(t,l,!1,e,u)}else c||Object(ye.t)(t,i,"Tile_Carousel_Offer_Impression","Tile",e,!0);(null===(d=null===Ft.a||void 0===Ft.a?void 0:Ft.a.flightParams)||void 0===d?void 0:d.isLegacyLoggerToNewLoggerForwardingEnabled)?Object(vt.a)({entities:Object(z.a)(Object(ft.a)(i,null==i?void 0:i.length),(function(e){return Object(Pt.b)(e,s,"EmployeeOffer")})),loggerProps:{layout:{entity:{isAnswer:!1,cardType:"Tile"}},position:1}},o||c?"Mainline_RichPill_Impression":"Tile_Carousel_Offer_Impression",!1):Object(It.i)({logger:t,entities:Object(ft.a)(i,null==i?void 0:i.length),domain:l,isHero:!1,traceId:s,latency:n.calculateEndTime().duration,eventId:o||c?"Mainline_RichPill_Impression":"Tile_Carousel_Offer_Impression",layoutProps:{childPlacementType:"Hidden"}}),Object(ye.q)(t,e,a,"None")}}),[t,e,i,r,l,a,c,o]),null},Bt=n(1135),Dt=n(480),Ht=n(174),Wt=n(598),zt=n(248),qt=function(){return Promise.all([n.e(4),n.e(154)]).then(n.bind(null,2955)).then((function(e){return{default:e.NotificationSlidingBar}}))},Kt=function(e){return Object(zt.b)(qt,{chunkName:"serpfre"},Object(k.a)())(e)},Qt=function(){return n.e(126).then(n.bind(null,2954)).then((function(e){return{default:e.NotificationSlidingBarVNext}}))},Ut=function(e){return Object(zt.b)(Qt,{chunkName:"mobilefre"},Object(k.a)())(e)},Vt=function(e){var t=e.profileButton,n=e.isMobile,i=e.hideTeaser,r=Object(k.a)(),a=Object(Ot.b)(),o=Object(T.useSelector)(mt.b),c=Object(T.useDispatch)(),l=Object(N.t)(),s=Object(B.a)("MainlineFirstRun"),u=s.hasNotificationKind,d=s.notificationConfig,m=Object(Dt.c)(),p=Object(T.useSelector)(Et.k),g=Object(T.useSelector)(_.M),v=Object(T.useSelector)(P.p),h=Object(Ht.a)(),O=Object(Y.e)(),j=Object(Y.b)(),E=h.searchOptions.buildBingWorkVerticalUrl,x=Object(T.useSelector)(P.s),S=Object(T.useSelector)(P.f),C=Object(T.useSelector)(P.j),y=Object(D.a)("MainlineFirstRun","MainlineFirstRunNotificationContainer",o,!0),w=function(){d&&Object(M.b)(r,d,"Impression"),y.logImpression()},L=null==d?void 0:d.notificationCampaign,I=0;"RetentionCampaign"===L&&(I=C);var F=Object(T.useSelector)(P.d),A=Object(T.useSelector)(pt.d),R="Person"===A&&F>0;if(!u||i)return f.createElement(f.Fragment,null,t);var H=!n&&v&&!l&&("SearchCampaign"===L||"EduCampaign"===L),W=Object(Xe.a)(L||""),z=!a||H,q=function(){y.logEngagementClick(),z&&E&&p?window.location.href=E({query:p},void 0,W):c(Object(Wt.a)({isTourOpen:!0}))},K=Object(b.Jb)(L,I,l,R,F,A,n,x?S:0),Q=f.createElement(f.Fragment,null,K);return n?f.createElement(Ut,{notificationKind:"MainlineFirstRun",message:Q,logImpression:w,onClick:q,shouldAnimate:m,isAdminThemeEnabled:g,navBarColor:j}):f.createElement(Kt,{notificationKind:"MainlineFirstRun",profileButton:t,message:K,logImpression:w,onClick:q,shouldAnimate:m,isAdminThemeEnabled:g,textIconColor:O,disableProfileImage:x})},Gt=n(1064);function Jt(e){var t=Object(Gt.c)(e);return t&&t.provenance}var Yt=n(458),$t=n(2566),Xt=n(956),Zt=n(592),en=n(2870),tn=n(2856),nn=n(2875),rn=n(491),an=n(1202),on=n(740),cn=n(1174),ln=n(97),sn=n(633),un=n(643),dn=n(2938),bn=n(1180),mn=n(141),pn=n(238),fn=n(393),gn=n(1149),vn=n(418),hn=n(153),On=hn.h,jn={boxSizing:"border-box",width:"".concat(120,"px"),height:"".concat(On,"px"),borderRadius:ve.a},En=Object(ue.b)((function(e,t,n,i){return Object(E.K)({scopeCardFrame:[Object(de.f)(e),jn,{borderBottom:t?"4px solid ".concat(n):void 0,backgroundColor:e.palette.white,cursor:i?"pointer":void 0,padding:"8px",selectors:{":hover":t?void 0:{boxShadow:Object(de.j)(e)}}}]})})),xn=n(311),Sn=n(264),Cn=n(143),yn=n(716),kn=n(2020),wn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onKeyPress=function(e){Object(m.o)(e,t.props.onClick)},t}return Object(ln.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.ariaLabel,n=e.className,i=e.isSelected,r=e.selectionAccentColor,a=e.onClick,o=e.theme,c=e.children,l=En(o,i,r,!!a);return f.createElement("div",{role:"button",className:Object(kn.a)(l.scopeCardFrame,n),onClick:a,onKeyPress:this.onKeyPress,"aria-label":t,"aria-expanded":i,tabIndex:0},c)},t}(f.Component),Nn=Object(se.a)(wn),_n=Object(ue.b)((function(e,t,n,i){var r=n===Ne.J||n===Ne.E;return Object(E.K)({circleContainer:{margin:"12px 0 17px",height:"72px",textAlign:"center"},circle:{display:"inline-block",width:"72px",height:"72px",border:"1px solid ".concat(e.palette.neutralQuaternaryAlt),borderRadius:"50%",backgroundColor:e.palette.white},icon:[r?Ue.h:Ue.g,{position:"relative",top:r?"16px":"20px",display:"inline-block",color:i||t},{selectors:{svg:{selectors:{"> path":{fill:i||t}}}}}],title:[Object(O.m)(e),j.i],detail:[m.b,Object(he.j)(e),j.i,{marginTop:"2px",height:"68px",whiteSpace:"normal"}]})})),Ln=function(e){var t=e.className,n=e.title,i=e.subtitle,r=e.tenantThemeColor,a=e.iconName,o=e.iconColorOverride,c=e.isSelected,l=e.onClick,s=Object(p.a)(),u=_n(s,r,a,o);return f.createElement(Nn,{ariaLabel:Object(Cn.u)({scopeCardTitle:n}),className:t,isSelected:c,selectionAccentColor:r,onClick:l},f.createElement("div",{className:u.circleContainer},f.createElement("div",{className:u.circle},a&&f.createElement(oe.a,{className:u.icon,iconName:a}))),f.createElement("div",{className:u.title},n),f.createElement("div",{className:u.detail},i))},Mn=n(641),Tn=n(233),Pn=n(416),In=n(234),Fn=n(270),An=n(182),Rn=n(594),Bn=n(103),Dn=n(1972),Hn=n(955),Wn=(Object(Bn.declareStringWithPlaceholders)("search-hostapp.search.expandableScopeCard.countWithPlus")),zn=(Object(Bn.declareStringWithPlaceholders)("search-hostapp.search.expandableScopeCard.domainCountSummary")),qn=n(420),Kn=n(522),Qn="-".concat("10px"),Un=Object(v.a)((function(e,t){var n;return Object(E.K)({scopeCardSummaryWrapper:{display:"inline-block",verticalAlign:"top",position:"relative",pointerEvents:t?"none":void 0},scopeCardContentWrapper:{display:"inline-block",verticalAlign:"top",position:"relative",marginBottom:"-".concat(ve.g+Kn.b,"px"),marginLeft:"".concat(-120,"px"),pointerEvents:t?void 0:"none"},seeMoreLink:{float:"right"},footerContentWrapper:{paddingTop:"16px"},privacyInfoButton:{position:"absolute",top:"4px",right:"4px",cursor:"pointer",selectors:(n={i:{color:e.palette.black}},n[".".concat(qn.b)]={marginTop:Qn,marginRight:Qn,padding:"10px"},n[".".concat(qn.c)]={marginTop:Qn},n)},scopeContentCollapseButton:{position:"absolute",top:"20px",right:"20px"},privacyMessage:{marginBottom:"8px"}})})),Vn=n(718),Gn=n(1101),Jn=n(156),Yn=n(1100),$n=Object(v.a)((function(e,t){var n=[Object(Ue.j)("".concat((t-2)/2,"px")),{position:"absolute",fontWeight:800}];return Object(E.K)({arrowExpansionButton:[Yn.a,{height:"".concat(t,"px"),width:"".concat(t,"px"),color:e.palette.neutralPrimaryAlt,cursor:"pointer"}],topIcon:[n,{top:0,right:0}],bottomIcon:[n,{bottom:0,left:0,transform:"rotate(180deg)"}]})})),Xn=function(e){var t=e.isExpanded,n=e.onSetExpanded,i=e.size,r=e.className,a=e.ariaLabel,o=f.useCallback((function(){n(!t)}),[t,n]),c=Object(p.a)();if(!t)return null;var l=$n(c,i);return f.createElement("button",{"aria-label":a,"aria-expanded":t,tabIndex:0,className:Object(kn.a)(r,l.arrowExpansionButton),onClick:o},f.createElement(oe.a,{className:l.topIcon,iconName:"ArrowDownRightMirrored8"}),f.createElement(oe.a,{className:l.bottomIcon,iconName:"ArrowDownRightMirrored8"}))},Zn=n(1245),ei=n(476),ti=f.forwardRef((function(e,t){var n=e.title,i=e.resultCountSubTitle,r=e.breadCrumbSubTitle,a=e.items,o=e.renderItem,c=e.footerContent,l=e.expansionButtonAriaLabel,s=e.hideTenantBranding,u=e.onExpansionButtonClick,d=e.hideExpansionArrows,b=e.onTitleClick,m=e.titleHref,g=e.processedQuery,v=e.verticalTitle,h=e.noListTitle,O=e.isSmall,j=e.isMiniSerp,E=e.isTitleDisabled,x=e.privacyMessageNode,S=e.isEduEnabled,C=Object(p.a)(),y=Object(ei.f)(C,s,O),k=Object(Cn.j)(g,n);f.useEffect((function(){Jn.a.capturePerformance({currentComponent:"ScopeContentList.web"})}),[]);var w={title:k,resultCountSubTitle:i,onTitleClick:b,titleHref:m,verticalTitle:v||n,breadcrumbs:!j,isSmall:O,isEduEnabled:S},N=h?f.createElement("h2",{className:y.title},n):f.createElement(Zn.a,Object(ln.__assign)({},w));return f.createElement(f.Fragment,null,!s&&f.createElement(dt.a,null),f.createElement("div",{ref:t,className:y.scopeContentList},!d&&u&&f.createElement(Xn,{ariaLabel:l,className:y.scopeContentCollapseButton,size:16,isExpanded:!0,onSetExpanded:u}),E?x:N,r&&f.createElement("h3",{className:y.textSubTitle},r),Object(z.a)(a,(function(e,t){return f.createElement("div",{key:t,className:y.listItem},o(e,t))})),c))})),ni=n(227),ii=Object(v.a)((function(){return Object(E.K)({expandable:{paddingBottom:"".concat(ve.g+Kn.b,"px")}})})),ri=function(e){var t=Object(ni.a)("ExpandableScopeCardContent"),n=t[0],i=t[1],r=e.isVisible,a=e.scopeContentListProps,o=ii();return f.createElement(Vn.a.Provider,{value:{isTabStopEnabled:r}},f.createElement(Gn.a,{className:o.expandable,duration:500,isExpanded:r,initialHeight:On,initialWidth:120,expandedWidth:r?i.offsetWidth:120,expandedHeight:r?i.offsetHeight:On,transitionTimingFunction:ai},f.createElement(ti,Object(ln.__assign)({},a,{ref:n}))))},ai="cubic-bezier(0.3,0.55,0.1,1.0)",oi=Object(yn.c)(500,ai),ci=Object(yn.b)(500,ai),li=function(e){var t=e.showSeeMoreLink,n=e.seeMoreLinkText,i=e.query,r=e.domain,a=e.isSelected,o=e.showMediumExpansionButton,c=e.isMediumExpanded,l=e.onExpandLinkClick,s=e.onSeeMoreLinkClick,u=Object(p.a)(),d=Un(u,a);return f.createElement("div",{className:d.footerContentWrapper},o&&f.createElement(vn.a,{isExpanded:!c,onClick:l}),t&&i&&f.createElement(xn.a,{iconName:"ChevronRight",url:Object(In.a)(i,r),className:d.seeMoreLink,onClick:s,text:n||Object(Cn.A)()}))},si=Object(T.connect)((function(e,t){var n=t.domain,i=t.title,r=t.conversationProvenance,a=t.seeMoreLinkQueryOverride;return{isSelected:Object(Fn.q)(e,n,i),isMediumExpanded:Object(Fn.i)(e,n,r),query:a||Object(_.x)(e),userUpn:Object(An.n)(e)}}),(function(e,t){return{toggleSelectScopeCardActions:function(n,i){var r=t.domain,a=t.title,o=t.conversationProvenance;e(Object(Tn.p)({source:"UserExplicit",selectedScopeCardDomain:n?r:void 0,selectedConnectorProvenance:"Connectors"===r&&n?a:void 0,selectedConversationProvenance:o})),e(Object(Tn.r)({elementId:n?i:void 0}))},setIsMediumExpanded:function(t){e(Object(Tn.u)({isMediumExpanded:t}))},scrollToCardAction:function(t){e(Object(Tn.r)({elementId:t}))},setCarouselScrollTargetToCarousel:function(){return e(Object(Tn.s)())}}}))(Object(Pn.a)((function(e){var t=e.items,n=e.className,i=e.domain,r=e.conversationProvenance,a=e.title,o=e.shortTitle,c=e.isSelected,l=e.isMediumExpanded,s=e.scrollToCardAction,u=e.renderScopeListItem,d=e.seeMoreLinkText,b=e.query,m=e.userUpn,g=e.tenantThemeColor,v=e.toggleSelectScopeCardActions,h=e.setIsMediumExpanded,O=e.setCarouselScrollTargetToCarousel,j=e.isFirstItemEnhanced,E=e.isHero,x=e.impressionEventId,S=e.clickEventId,C=e.groupClickEventId,y=e.traceId,_=e.eventScope,L=e.scopeContentListLoggerProps,M=Object(St.a)(t),P=Object(gn.a)();f.useEffect((function(){c&&s(P)}),[c]);var I=Object(p.a)(),F=Object(Rn.d)(i,M,"List",l,j),A=F.shownCount,R=F.showSeeMoreLink,B=function(e,t,n){var i=String(e),r=t?Wn({count:i}):String(i);if("Turing"===n||"PowerBi"===n||"Connectors"===n)return Object(Cn.s)({count:e,showPlus:t});var a=Object(Dn.a)(Object(Hn.a)(n,void 0,1===e&&!t));return zn({countWithOptionalPlus:r,domainStr:a})}(A,R,i),D=Un(I,c),H=Object(Rn.c)(i),W=Object(Rn.b)(i),z=Object(w.b)(),q=Object(k.a)(),K=Object(T.useSelector)((function(e){return Object(Et.i)(e,i)})),Q=Object(Mn.d)({entities:t,domain:i,isHero:!!E,impressionEventId:x,clickEventId:S,cardType:"Scope",traceId:y,eventScope:_,layoutProps:Object(ln.__assign)({childPlacementType:c?"Visible":"Partial"},L)}),U={title:o||a,subtitle:B,iconName:H,iconColorOverride:W,tenantThemeColor:g,isSelected:c,onClick:function(){v(!c,P),Q.nonEntityActions.onSearchActionClick(C)}},V=Object(N.t)(),G=c?ci:oi,J=c?oi:ci,Y=f.useCallback((function(){v(!1,P);var e=P&&document.getElementById(P);e&&e.offsetLeft+120<document.documentElement.clientWidth&&O()}),[v,O,P]),$=function(e,t){Q.entityActions.onEntityClick(e,void 0,{url:t,clientSize:z},"File_Modifier_Profile_Click")},X=f.useCallback((function(e){h(!e)}),[]);if(0===M)return null;var Z=j?M>1:M>Rn.a,ee=f.createElement(li,{query:b,domain:i,showSeeMoreLink:R,seeMoreLinkText:d,conversationProvenance:r,userUpn:m,isSelected:c,showMediumExpansionButton:Z,isMediumExpanded:l,onExpandLinkClick:X,onSeeMoreLinkClick:function(){Object(re.n)(q,i,z)}}),te=Object(Sn.b)(Object(Cn.u)({scopeCardTitle:a}),Object(Cn.c)()),ne={title:a,items:Object(ce.a)(t,A),footerContent:ee,renderItem:function(e,t){return u(e,t,(function(){return Q.entityActions.onEntityClick(e,t)}),(function(n){return Q.entityActions.onActionClick(e,n,t)}),Y,(function(e,t){return Q.entityActions.onEntityClick(e,void 0,void 0,t)}),$)},expansionButtonAriaLabel:te,hideTenantBranding:!c,onExpansionButtonClick:Y,processedQuery:K,isEduEnabled:V};return f.createElement(De.a,{codeLocation:"ExpandableScopeCard.".concat(i)},f.createElement("li",{id:P,className:Object(kn.a)(n,"ms-search-scopeCard")},f.createElement("div",{className:Object(kn.a)(D.scopeCardSummaryWrapper,G)},f.createElement(Ln,Object(ln.__assign)({},U))),f.createElement("div",{className:Object(kn.a)("ms-search-scopeCardContent",D.scopeCardContentWrapper,J)},f.createElement(ri,{isVisible:c,scopeContentListProps:ne}))))}))),ui=n(490),di=n(342),bi=n(525),mi=n(485),pi=n(649),fi=n(1589),gi=function(e){var t=Object(fi.a)(),n=e.className,i=e.isSmall,r=e.onClickLearnMore;return f.createElement(pi.a,{className:n,message:t,isSmall:i,onClickLearnMore:r})},vi=n(463),hi=function(e){var t=Object(vi.b)(),n=e.className,i=e.isSmall,r=e.onClickLearnMore;return f.createElement(pi.a,{className:n,message:t,isSmall:i,onClickLearnMore:r})},Oi=n(2614),ji=n(351),Ei=function(e){var t=Object(ji.j)(),n=e.className,i=e.isSmall,r=e.onClickLearnMore;return f.createElement(pi.a,{className:n,message:t,isSmall:i,onClickLearnMore:r})},xi=n(412),Si=function(e){var t=Object(xi.e)(),n=e.className,i=e.isSmall,r=e.onClickLearnMore;return f.createElement(pi.a,{className:n,message:t,isSmall:i,onClickLearnMore:r})},Ci=function(e){var t=e.domain,n=e.className,i=e.isSmall,r=e.onClickLearnMore;switch(t){case"File":return f.createElement(Oi.a,{className:n,isSmall:i,onClickLearnMore:r});case"Site":return f.createElement(Si,{className:n,isSmall:i,onClickLearnMore:r});case"Connectors":return f.createElement(gi,{className:n,isSmall:i,onClickLearnMore:r});case"Message":return f.createElement(hi,{className:n,isSmall:i,onClickLearnMore:r});case"PowerBi":return f.createElement(Ei,{className:n,isSmall:i,onClickLearnMore:r});default:return null}};function yi(e){return"EducationAssignment"===e}var ki="-".concat("10px"),wi=Object(v.a)((function(e,t){var n,i,r;return Object(E.K)({scopeCardContentWrapper:{display:"inline-block",verticalAlign:"top",position:"relative",marginBottom:t?"0px":"-".concat(ve.g+Kn.b,"px"),selectors:(n={},n[".".concat(ei.a)]={border:"none",borderRadius:"unset"},n),width:"100%"},noResults:{margin:"0px 24px 16px",selectors:(i={},i[".".concat(ui.c)]={fontSize:"16px"},i)},privacyInfoButton:{position:"absolute",top:"4px",right:"4px",cursor:"pointer",selectors:(r={i:{color:e.palette.black}},r[".".concat(qn.b)]={marginTop:ki,marginRight:ki,padding:"10px"},r[".".concat(qn.c)]={marginTop:ki},r)},privacyMessage:{marginBottom:"8px"}})})),Ni=function(e){var t=e.items,n=e.domain,i=e.title,r=e.showSubTitle,a=void 0!==r&&r,o=e.renderScopeListItem,c=e.className,l=e.verticalTitle,s=e.isHero,u=e.impressionEventId,d=e.clickEventId,b=e.traceId,m=e.eventScope,g=e.isTitleDisabled,v=e.isMarginDisabled,h=e.scopeContentListLoggerProps,O=e.titleHrefOverride,j=e.processedQueryOverride,E=e.maxItemsShown,x=e.breadCrumbSubTitle,S=Object(St.a)(t),C=Object(Ht.a)().searchOptions.buildBingWorkVerticalUrl,y=Object(T.useSelector)(di.l),_=Math.min(S,void 0!==E?E:3),L=Object(p.a)(),P=Object(mi.c)(),I=wi(L,v),F=Object(k.a)(),A=Object(w.b)(),R=Object(fn.d)(),B=Object(T.useSelector)((function(e){return Object(Et.i)(e,n)}));B=j||B;var D=Object(w.o)(),H=Object(w.j)(),W=Object(bt.d)(),z=Object(T.useSelector)((function(e){return Object(mt.c)(e)}));z=z||"Pole";var q=Object(T.useSelector)(mt.b),K=Object(T.useSelector)(mt.e);K=K||"Mop-3";var Q=Object(Mn.d)({entities:Object(ce.a)(t,_),domain:n,isHero:!!s,impressionEventId:u,clickEventId:d,cardType:"Scope",traceId:b,eventScope:m,layoutProps:h}),U=Object(N.t)(),V=Object(N.f)(),G=Object(bi.b)(Object(bi.a)("High"),V),J=f.useState(!1),Y=J[0],$=J[1];f.useEffect((function(){W&&!Y&&S>0&&(Object(ye.o)(F,A,z),Object(ye.q)(F,A,"High",void 0,z),Object(M.a)(F,Object(bi.a)("High"),"ScopeContentListContainerImpression"),V&&G.logImpression(),$(!0))}),[W,F,A,S]);var X=void 0;if(O?X=O:R&&(X=C?D&&!H?C(R,n,l):C(R,n):void 0),W&&!y)return f.createElement(f.Fragment,null);if(W&&y&&0===S)return st(z,void 0,q),f.createElement(f.Fragment,null);if(0===S&&!W)return P?f.createElement(ui.d,{query:P,className:I.noResults,isMainline:!0}):null;var Z=function(e,t){Q.entityActions.onEntityClick(e,void 0,{url:t,clientSize:A},"File_Modifier_Profile_Click")},ee=f.createElement(Ci,{className:I.privacyMessage,domain:n,isSmall:!0}),te={title:i,resultCountSubTitle:a?t&&Object(Cn.s)({count:t.length}):void 0,breadCrumbSubTitle:x,items:Object(ce.a)(t,_),renderItem:function(e,t){return o(e,t,(function(){return Q.entityActions.onEntityClick(e,t)}),(function(n){return Q.entityActions.onActionClick(e,n,t)}),void 0,(function(e,t){return Q.entityActions.onEntityClick(e,void 0,void 0,t)}),Z)},hideTenantBranding:!0,hideExpansionArrows:!0,processedQuery:B,onTitleClick:function(){Object(re.c)(F,A,n,s)},titleHref:X,verticalTitle:l,noListTitle:yi(n),isSmall:D,isMiniSerp:H,isTitleDisabled:g,privacyMessageNode:ee,isEduEnabled:U};return f.createElement(De.a,{codeLocation:"ScopeContentList.".concat(n)},f.createElement("div",{className:Object(kn.a)(c,"ms-search-scopeCardContent",I.scopeCardContentWrapper)},f.createElement(ti,Object(ln.__assign)({},te))))},_i=function(e){var t=e.className,n=e.isMainline,i=e.renderLoadingState,r=e.scopeContentListLoggerProps,a=e.title,o=e.titleHref,c=Object(fn.d)(),l=Object(T.useSelector)((function(e){return Object(pn.m)(e,void 0,mn.b,void 0)})),s=Object(w.x)().buildBingWorkVerticalUrl,u=Object(T.useSelector)(pn.l),d=Object(bn.b)(void 0,!1,mn.b,mn.c,void 0,void 0,void 0),b=Object(T.useSelector)((function(e){return Object(pn.b)(e,void 0,mn.b,void 0)})),m=Object(T.useSelector)(_.n);a=(null==b?void 0:b.VerticalDisplayName)||a;var p=null==b?void 0:b.VerticalLogicalId;p&&c&&(o=s&&s(Object(ln.__assign)(Object(ln.__assign)({},c),{normalizedQuery:m}),"Connectors-"+p,void 0));if(l)return i();var g={className:t,domain:"Connectors",title:a,titleHrefOverride:o,items:d,renderScopeListItem:function(e,t,n){if(Object(sn.b)(e.layout.LayoutId)){var i={file:Object(sn.a)(e),onClick:n};return f.createElement(dn.a,Object(ln.__assign)({},i))}return f.createElement(un.a,{data:e.Source,layout:e.layout,key:t,onClick:n,hitHighlightedSummary:e.HitHighlightedSummary})},seeMoreLinkQueryOverride:m||void 0,processedQueryOverride:m||void 0,isHero:u,impressionEventId:u?"Scope_AutoExpanded_Connectors_Impression":"Scope_Connectors_Impression",clickEventId:u?"Connectors_AutoExpanded_Insight_Click":"Connectors_Insight_Click",groupClickEventId:u?"Connectors_AutoExpanded_ScopeCard_Click":"Connectors_ScopeCard_Click",isMainline:n,scopeContentListLoggerProps:r};return n?f.createElement(Ni,Object(ln.__assign)({},g)):f.createElement(si,Object(ln.__assign)({},g))},Li=n(218),Mi=n(244),Ti=n(1226),Pi=n(179),Ii=n(221),Fi=n(235),Ai=n(201),Ri=n(132),Bi=n(286),Di=n(281),Hi=n(442);function Wi(e,t,n,i,r){void 0===i&&(i=!0),void 0===r&&(r=new Date);var a=r.getTime(),o=new Date(t),c=a-o.getTime(),l=Math.floor(c/Di.c),s=!i,u=Object(Hi.a)(o,r,s);if("Link"===e||"Attachment"===e)return Object(Ai.l)(r,o)?i?Object(Mi.q)({name:n}):Object(Mi.p)({name:n}):Object(Ri.v)(o,r)?i?Object(Mi.s)({name:n}):Object(Mi.r)({name:n}):l<r.getDay()?i?Object(Mi.m)({name:n,day:Object(Bi.a)(o.getDay())}):Object(Mi.l)({name:n,day:Object(Bi.a)(o.getDay())}):l<Di.J/Di.c+r.getDay()?i?Object(Mi.k)({name:n}):Object(Mi.j)({name:n}):o.getMonth()===r.getMonth()&&o.getFullYear()===r.getFullYear()?i?Object(Mi.o)({name:n}):Object(Mi.n)({name:n}):i?Object(Mi.m)({name:n,day:u}):Object(Mi.l)({name:n,day:u});var d=new Date(t),b=new Date,m=Object(Hi.b)(d,b),p=Object(Mi.w)(m,n,!0);return m?p:Ki(p)}function zi(e,t){return(t.getTime()-e.getTime())/Di.E}function qi(e,t){return e.setHours(0,0,0,0),t.setHours(0,0,0,0),Math.floor((t.getTime()-e.getTime())/Di.c)}function Ki(e){var t;return(null===(t=e[0])||void 0===t?void 0:t.toUpperCase())+e.substr(1)}function Qi(e,t,n){var i,r,a,o,c,l=e.propertyHits,s=e.dateAccessed,u=e.dateCreated,d=e.sender,b=e.author,m=e.authorEmail,p=e.lastModifiedByFullName,f=e.lastModifiedTime,g=e.lastModifiedByEmail,v=e.sharedDateTime,h=e.userRelationshipType;if(l){var O=Ki(Object(Mi.N)());if("None"===h&&d&&d.emailAddress.name&&d.emailAddress.address&&v)c=d.emailAddress.name===n?O:d.emailAddress.name,o=d.emailAddress.name,a=d.emailAddress.address,r=Wi("Link",v,"");else if(Object(I.a)(l,"EmailSenderName")&&d&&d.emailAddress.name&&d.emailAddress.address&&u)o=c=null===(i=d.emailAddress)||void 0===i?void 0:i.name,a=d.emailAddress.address,r=Wi("Link",u,"");else if(Object(I.a)(l,"Author")&&b&&m&&u)c=b===n?O:b,r=function(e,t){void 0===t&&(t=new Date);var n=new Date(e),i=zi(n,t),r=qi(n,t);if(i<Di.g/Di.E){var a=Math.ceil(i*Di.E/Di.p);return Object(Mi.d)({minutes:a.toString()})}if(i<Di.c/Di.E){var o=Math.ceil(i*Di.E/Di.g);return Object(Mi.c)({hours:o.toString()})}return Object(Ri.v)(n,t)?Object(Mi.f)():r<7?Object(Mi.b)({days:r.toString()}):Object(Ai.a)(n,t)?Object(Mi.e)({date:Object(Hi.a)(n,t)}):Object(Mi.e)({date:n.toDateString()})}(u),a=m,o=b;else if(s&&t&&n)c=O,a=t,r=function(e,t){void 0===t&&(t=new Date);var n=new Date(e),i=zi(n,t),r=qi(n,t);if(i<Di.g/Di.E){var a=Math.ceil(i*Di.E/Di.p);return Object(Mi.F)({minutes:a.toString()})}if(i<Di.c/Di.E){var o=Math.ceil(i*Di.E/Di.g);return Object(Mi.E)({hours:o.toString()})}return Object(Ri.v)(n,t)?Object(Mi.G)():r<7?Object(Mi.D)({days:r.toString()}):Object(Ai.a)(n,t)?Object(Mi.C)({date:Object(Hi.a)(n,t)}):Object(Mi.C)({date:n.toDateString()})}(s),o=n;else{if(!(f&&g&&t&&n&&p===n))return;c=O,a=t,r=Object(Mi.w)(f),o=n}return{subtitle:r,fullName:c,subtitleLinkEmail:a,subtitleLinkName:o}}}var Ui=function(e){var t=e.className,n=e.isMainline,i=e.renderLoadingState,r=e.scopeContentListLoggerProps,a=Object(T.useSelector)(_.F),o=Object(T.useSelector)(Fn.a),c=Object(T.useSelector)(_.Wb),l={pageNumber:mn.b,pageSize:mn.c,aggregations:void 0,refiningQueries:void 0,extendedQueryTemplate:void 0,isEnabled:!0,isNLFileSearchEnabled:!1,is3SFileRequired:c?a&&!o:a},s=Object(Ti.a)(l).items,u=Object(T.useSelector)(Fi.e),d=Object(T.useSelector)(Fi.j),b=Object(T.useSelector)((function(e){return Object(Fi.i)(e,void 0,void 0,void 0,a)})),m=Object(T.useSelector)(Et.D),p=Object(T.useSelector)(_.G),g=Object(J.i)(),v=Object(J.h)(),h=Object(Ii.a)(),O=h.buildRequeryUrl,j=h.requery,E=Object(Pi.b)(mn.b,void 0),x=Object(w.j)()&&a;if(d?b:m)return i();var S={className:t,domain:"File",title:Object(Mi.h)(),items:s,renderScopeListItem:function(e,t,i,r,a,o,c){var l,s,u=Object(Ee.a)(e),b=u.lastModifiedByFullName,m=u.lastModifiedByEmail;if(d&&n&&p){var h=Qi(u,g,v);(null==h?void 0:h.subtitle)&&h.fullName&&h.subtitleLinkEmail&&h.subtitleLinkName&&(l=h.subtitle,b=h.subtitleLinkName,m=h.subtitleLinkEmail,s=h.fullName)}var E=!!b&&O(b,Li.f,m);return f.createElement(dn.a,{key:t,file:u,onClick:i,subtitleLink:E||void 0,onAuthorClick:function(t){c&&c(e,E||void 0),b&&j(t,b,Li.f,m)},subtitle:l,subtitleLinkFullName:s})},seeMoreLinkQueryOverride:u,isHero:d,impressionEventId:a&&d?"Hero_AutoExpanded_File_Answer_Impression":d?"Scope_AutoExpanded_File_Impression":"Scope_File_Impression",clickEventId:d?"File_AutoExpanded_Insight_Click":"File_Insight_Click",groupClickEventId:d?"File_AutoExpanded_ScopeCard_Click":"File_ScopeCard_Click",isMainline:!1,scopeContentListLoggerProps:r},C=Object(ln.__assign)(Object(ln.__assign)({},S),{verticalTitle:Object(Mi.t)(),isMainline:!0,traceId:E,isTitleDisabled:x,isMarginDisabled:x});return n?f.createElement(Ni,Object(ln.__assign)({},C)):f.createElement(si,Object(ln.__assign)({},S))},Vi=function(e){var t=e.domain;switch(Jn.a.startAnswerProfiling(t),t){case"Acronym":case"Calendar":case"MeetingRoomProposal":case"Person":case"TuringQnA":return f.createElement(on.a,{domain:t});case"Topic":return f.createElement(cn.a,null,f.createElement(on.a,{domain:t}));case"Building":return f.createElement(tn.a,null);case"Bookmark":return f.createElement(en.a,null);case"Group":return f.createElement(an.a,null);case"Qna":return f.createElement(nn.a,null);case"File":return f.createElement(Ui,{isMainline:!0,renderLoadingState:function(){return f.createElement(rn.a,{isHeroExpanded:!0})},scopeContentListLoggerProps:{isAnswer:!0}});case"PeopleAlsoAsk":return null;case"CalendarAvailability":case"External":case"FileEntity":case"FileInferenceAnswer":case"Flight":case"Link":case"Message":case"Notification":case"PowerBi":case"Site":case"Turing":return f.createElement(_i,{isMainline:!0,renderLoadingState:function(){return f.createElement(rn.a,{isHeroExpanded:!0})},scopeContentListLoggerProps:{isAnswer:!0},title:"Connector"});case"Connectors":case"EducationAssignment":case"EducationClass":case"EmployeeOffer":case"EnterpriseLearning":case"FederatedSearch":case"FloorPlan":case"QueryReformulation":case"SharePoint":case"VivaQnA":return null;default:return Object(Yt.a)(t)}},Gi=n(115),Ji=n.n(Gi),Yi=n(1401),$i=n(1241),Xi=n(1215),Zi=n(207),er=n(757),tr=n(1616),nr=function(e){var t=e.className,n=e.isFederatedSearch,i=e.isMainline,r=e.modifiedQuery,a=e.renderLoadingState,o=e.scopeContentListLoggerProps,c=e.title,l=e.titleHref,s=e.onRenderAllItems,u=Object(T.useSelector)(Et.D),d=Object(T.useSelector)(Zi.h),b=Object(w.x)(),m=0,p=n?5:3,g=function(){if(d){var e=Math.min(p,d.length);(m+=1)>=e&&s&&s()}},v=Object(er.a)().connectorAsyncScopeCardContainer;if(u)return a();var h={className:t,domain:"Connectors",title:c,titleHrefOverride:l,items:d,renderScopeListItem:function(e,t,n){if(Object(sn.b)(e.layout.LayoutId)){var i={file:Object(sn.a)(e),onClick:n};return f.createElement(dn.a,Object(ln.__assign)({},i))}return f.createElement(un.a,{data:e.Source,layout:e.layout,key:t,onClick:n,onRender:g,hitHighlightedSummary:e.HitHighlightedSummary,onAnchorClickedOverride:function(e,t){if(!b.navigateToVertical)return!1;var n=Object(tr.a)(t,b.isDisabledCustomVertical);return!!n&&(b.navigateToVertical(n),!0)}})},seeMoreLinkQueryOverride:r||void 0,isHero:!0,impressionEventId:"Scope_AutoExpanded_Connectors_Impression",clickEventId:"Connectors_AutoExpanded_Insight_Click",groupClickEventId:"Connectors_AutoExpanded_ScopeCard_Click",isMainline:i,scopeContentListLoggerProps:o,isTitleDisabled:n,maxItemsShown:p};return i?f.createElement("div",{className:v},f.createElement("div",{id:"connectorAsyncScopeCardContainer"},f.createElement(Ni,Object(ln.__assign)({},h)))):f.createElement(si,Object(ln.__assign)({},h))},ir=function(e){var t=e.className,n=e.renderLoadingState,i=e.scopeContentListLoggerProps,r=Object(T.useSelector)($t.a),a=Object(T.useSelector)(Fi.e),o=Object(T.useSelector)($t.b),c=Object(T.useSelector)($t.f),l=Object(Ii.a)(),s=l.buildRequeryUrl,u=l.requery;if(c)return n();var d={className:t,domain:"File",title:Object(Mi.h)(),items:r,isHero:!0,renderScopeListItem:function(e,t,n,i,r,a,o){var c=Object(Ee.a)(e),l=c.lastModifiedByFullName,d=c.lastModifiedByEmail,b=!!l&&s(l,Li.f,d);return f.createElement(dn.a,{key:t,file:c,onClick:n,subtitleLink:b||void 0,onAuthorClick:function(t){o&&o(e,b||void 0),l&&u(t,l,Li.f,d)},subtitle:void 0,subtitleLinkFullName:void 0})},seeMoreLinkQueryOverride:a,impressionEventId:"QF_File_Impression",traceId:o,clickEventId:"QF_File_Insight_Click",groupClickEventId:"QF_File_Scopecard_Click",isMainline:!0,scopeContentListLoggerProps:i},b=Object(ln.__assign)(Object(ln.__assign)({},d),{verticalTitle:Object(Mi.t)(),isMainline:!0});return f.createElement(Ni,Object(ln.__assign)({},b))},rr=function(){return(rr=Ji.a||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},ar=function(e){var t=e.domain,n=e.onRender,i=Object(fn.d)(),r=Object(T.useSelector)(Zi.b),a=Object(T.useSelector)(Zi.e),o=Object(T.useSelector)(Zi.a),c=Object(T.useSelector)(Zi.f),l=Object(T.useSelector)(_.pc),s=Object(T.useSelector)(N.D),u=Object(T.useSelector)(A.a),d=s&&u,b=Object(T.useSelector)(_.zc),m=Object(T.useSelector)((function(e){return Object(Et.i)(e,t)})),p=Object(T.useSelector)(Zi.r),g=Object(T.useSelector)(Zi.p),v=Object(T.useSelector)(Zi.k),h=Object(w.x)().buildBingWorkVerticalUrl,O=Object(T.useSelector)((function(e){return Object(Zi.A)(e,"Connectors")})),j=null==p?void 0:p.VerticalLogicalId,E="Connector"===v?"Connectors":"FederatedSearch"===v?"FederatedSearch":t,x=function(){return f.createElement(rn.a,{isHeroExpanded:!0})};if(!("Connector"===v&&l||"FederatedSearch"===v&&b)||Object(Yi.a)(r)||Object(Yi.a)(a)){if(d&&"File"===t){var S=void 0;i&&(S=h&&h(rr(rr({},i),{normalizedQuery:O}),"Files",void 0));k={title:"File",titleHref:S,modifiedQuery:m,isMainline:!0,renderLoadingState:x,onRenderAllItems:n,isFederatedSearch:!1};return f.createElement(ir,rr({},k))}return f.createElement(Xi.HeroAdaptiveContainer,{adaptiveTemplateResponse:o,asyncAnswerEntity:c,domain:E,useHostAppStyles:!0,useHostConfigJson:!0,externalSourceType:v,onRender:n})}var C=(null==p?void 0:p.VerticalDisplayName)||"Connector",y=void 0;i&&(y=h&&h(rr(rr({},i),{normalizedQuery:O}),j?"Connectors-"+j:g,void 0));var k={title:C,titleHref:y,modifiedQuery:m,isMainline:!0,renderLoadingState:x,onRenderAllItems:n,isFederatedSearch:"FederatedSearch"===v};return f.createElement(nr,rr({},k))},or=function(e){var t=e.domain,n=e.onRender;return f.createElement($i.a,null,f.createElement(ar,{domain:t,onRender:n}))},cr=window.BingAtWork.Mainline,lr=function(){var e=Object(T.useSelector)(pt.d),t=Object(T.useSelector)(N.D),n=Object(A.a)(),i=t&&n;i&&(e="File");var r=Object(N.i)(),a=Object(T.useSelector)((function(t){return Object(pt.e)(t,e,!0,r,!0,i)})),o=Object(T.useSelector)(Zt.d),c=Object(T.useSelector)($t.d);i&&(o=o||i&&c);return e&&a?f.createElement(De.a,{codeLocation:"HeroCardRouterContainer.Bing.".concat(e)},f.createElement(sr,{heroDomain:e,renderingCardType:a,onAsyncResultsRendered:function(){o&&cr&&cr.unpreexpandIfHeightMismatched()}})):null},sr=function(e){var t=e.heroDomain,n=e.renderingCardType,i=e.onAsyncResultsRendered;switch(n){case"AsyncCard":return f.createElement(Xt.a,{domain:t,displayAsCard:!0,isTall:"External"===t,onNoAsyncResultsRender:i});case"HeroCard":return f.createElement(Vi,{domain:t});case"AdaptiveCard":return f.createElement(or,{domain:t,onRender:i});default:return Object(Yt.a)(n)}},ur=n(349),dr=n(560),br=n(1446),mr=n(741),pr=n(2888),fr=function(e){var t=e.className,n=e.isMainline,i=e.scopeContentListLoggerProps,r=Object(mr.a)(mn.b),a=Object(w.o)(),o=Object(w.d)(),c=Object(T.useSelector)(br.d),l=Object(T.useSelector)(_.vd),s=Object(ur.j)()+" > "+Object(ur.e)(),u={className:t,domain:"EducationAssignment",title:Object(ur.i)(),breadCrumbSubTitle:s,items:r,renderScopeListItem:function(e,t,i){var r=Object(dr.a)(e,o,void 0,!1,!1);return f.createElement(pr.a,{key:t,assignment:r,onClick:i,isSmall:a,isMainline:n,isSmallClickableTitle:l})},isHero:c,impressionEventId:c?"Scope_AutoExpanded_EducationAssignment_Impression":"Scope_EducationAssignment_Impression",clickEventId:c?"EducationAssignment_AutoExpanded_Insight_Click":"EducationAssignment_Insight_Click",groupClickEventId:c?"EducationAssignment_AutoExpanded_ScopeCard_Click":"EducationAssignment_ScopeCard_Click",isMainline:n,scopeContentListLoggerProps:i};return n?f.createElement(Ni,Object(ln.__assign)({},u)):null},gr=n(2915),vr=n(2380),hr=n(255),Or=n(925),jr=function(e){var t=e.className,n=e.isMainline,i=e.renderLoadingState,r=e.scopeContentListLoggerProps,a=Object(T.useSelector)(_.Nd),o=Object(bt.d)(),c=Object(vr.a)({pageNumber:mn.b,pageSize:o?mn.d:mn.c,showResultCluster:!1,aggregations:void 0,refiningQueries:void 0,isEnabled:!0,isSerpUsingSubstrateUnifiedSearch:!1,isNLFileSearchEnabled:!1,isTuringMarkerEnabled:a}).items,l=Object(T.useSelector)(di.m),s=Object(T.useSelector)(Et.D),u=Object(T.useSelector)(hr.i),d=Object(T.useSelector)(mt.b),b=Object(T.useSelector)(_.vd),m=u||o&&"High"===d,p=Object(vr.b)(mn.b,!1,void 0),g=Object(Ii.a)(),v=g.buildRequeryUrl,h=g.requery,O=f.useCallback((function(e,t,n,i,r,a,o){if("Site"===e.domain){var c={site:Object(Or.a)(e),onClick:n,isSmallClickableTitle:b};return f.createElement(gr.a,Object(ln.__assign)({},c))}var l=Object(Ee.a)(e),s=l.lastModifiedByFullName&&l.lastModifiedByEmail&&v(l.lastModifiedByFullName,Li.f,l.lastModifiedByEmail),u={file:l,onClick:n,subtitleLink:s,onAuthorClick:function(t){o&&o(e),l.lastModifiedByFullName&&l.lastModifiedByEmail&&h(t,l.lastModifiedByFullName,Li.f,l.lastModifiedByEmail)},isSmallClickableTitle:b};return f.createElement(dn.a,Object(ln.__assign)({},u))}),[p,m]),j=Object(Or.b)(c);if(m?l:s)return i();var E={className:t,domain:"Site",title:Object(Cn.I)(),items:j,renderScopeListItem:O,isHero:m,impressionEventId:m?"Scope_AutoExpanded_FilesAndSites_Impression":"Scope_FilesAndSites_Impression",clickEventId:m?"FilesAndSites_AutoExpanded_Insight_Click":"FilesAndSites_Insight_Click",groupClickEventId:m?"FilesAndSites_AutoExpanded_ScopeCard_Click":"FilesAndSites_ScopeCard_Click",traceId:p,eventScope:"FilesAndSites",isMainline:n,scopeContentListLoggerProps:r};if(n){var x=Object(ln.__assign)({verticalTitle:Object(Cn.a)()},E);return f.createElement(Ni,Object(ln.__assign)({},x))}return f.createElement(si,Object(ln.__assign)({},E))},Er=n(924),xr=n(413),Sr=n(1181),Cr=n(1618),yr=n(780),kr=function(e){var t=e.className,n=e.isMainline,i=e.scopeContentListLoggerProps,r=Object(gt.a)(),a=Object(p.a)(),o=Object(T.useSelector)(_.vd),c={className:t,domain:"EmployeeOffer",title:Object(xr.j)(),items:r,renderScopeListItem:function(e,t,n,i){var r=Object(Er.a)(e),c=Object(Sr.a)(a).imageIcon,l=f.createElement(yr.a,{imageId:r.imageId,title:r.provider,className:c});return f.createElement(Cr.a,{offer:r,offerIcon:l,onClick:n,onLocateStoreClick:function(){return i("Offer_LocateStore_Click")},isSmallClickableTitle:o})},impressionEventId:"Scope_Offer_Impression",clickEventId:"Offer_Insight_Click",groupClickEventId:"Offer_ScopeCard_Click",isMainline:n,scopeContentListLoggerProps:i};return n?f.createElement(Ni,Object(ln.__assign)({},c)):null},wr=n(2914),Nr=n(2968),_r=n(1227),Lr=n(540),Mr=n(296),Tr=n(1254),Pr=function(e){var t=e.className,n=e.isMainline,i=e.renderLoadingState,r=e.scopeContentListLoggerProps,a=Object(_r.a)().items,o=Object(T.useSelector)(Mr.e),c=Object(T.useSelector)(Mr.i),l=Object(T.useSelector)(Et.D),s=Object(T.useSelector)(Mr.h),u=Object(Cn.z)({source:Object(ji.c)()}),d=Object(Lr.a)(),b=Object(T.useSelector)(_.vd);if(c?s:l)return i();var m={className:t,domain:"PowerBi",title:Object(ji.c)(),items:a,seeMoreLinkText:u,renderScopeListItem:function(e,t,n){var i=Object(Tr.a)(e);return f.createElement(wr.a,{key:t,powerBi:i,onClick:n,isSmallClickableTitle:b})},seeMoreLinkQueryOverride:o,isHero:c,impressionEventId:c?"Scope_AutoExpanded_PowerBi_Impression":"Scope_PowerBi_Impression",clickEventId:c?"PowerBi_AutoExpanded_Insight_Click":"PowerBi_Insight_Click",groupClickEventId:c?"PowerBi_AutoExpanded_ScopeCard_Click":"PowerBi_ScopeCard_Click",isMainline:n,scopeContentListLoggerProps:r};return d?f.createElement(Nr.a,{isMainline:n}):n?f.createElement(Ni,Object(ln.__assign)({},m)):f.createElement(si,Object(ln.__assign)({},m))},Ir=n(180),Fr=n(1253);function Ar(e){return{keyword:Object(hr.e)(e),isFetchingSites:Object(hr.h)(e),sites:Object(hr.d)(e)}}var Rr=function(e,t){return{fetchSites:function(n,i,r){return Object(ln.__awaiter)(void 0,void 0,void 0,(function(){return Object(ln.__generator)(this,(function(a){switch(a.label){case 0:return[4,e(Object(Fr.a)(t.appContext,n,r,i))];case 1:return[2,a.sent()]}}))}))}}};var Br,Dr,Hr=Object(T.connect)((function(e){return{isFetchingSites:Object(hr.h)(e),isFetchingAnyAsyncResults:Object(Et.D)(e),isHero:Object(hr.i)(e)}}))(Object(Ir.a)((Br=function(e){var t=e.className,n=e.isHero,i=e.isFetchingSites,r=e.isFetchingAnyAsyncResults,a=e.isMainline,o=e.renderLoadingState,c=e.sites,l=e.keyword,s=e.scopeContentListLoggerProps,u=Object(T.useSelector)(_.vd);if(n?i:r)return o();var d={className:t,domain:"Site",title:Object(xi.c)(),items:c,seeMoreLinkQueryOverride:l,renderScopeListItem:function(e,t,n){return f.createElement(gr.a,{key:t,site:Object(Or.a)(e),onClick:n,isSmallClickableTitle:u})},isHero:n,impressionEventId:n?"Scope_AutoExpanded_Site_Impression":"Scope_Site_Impression",clickEventId:n?"Site_AutoExpanded_Insight_Click":"Site_Insight_Click",groupClickEventId:n?"Site_AutoExpanded_ScopeCard_Click":"Site_ScopeCard_Click",isMainline:a,scopeContentListLoggerProps:s};return a?f.createElement(Ni,Object(ln.__assign)({},d)):f.createElement(si,Object(ln.__assign)({},d))},Dr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(ln.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=(e.fetchSites,Object(ln.__rest)(e,["fetchSites"])),n=Object(ln.__assign)({},t);return f.createElement(Br,Object(ln.__assign)({},n))},t.prototype.componentDidMount=function(){this.initializeData()},t.prototype.componentDidUpdate=function(e){this.initializeData(e)},t.prototype.initializeData=function(e){var t=this.props,n=t.keyword,i=t.keywordOverride,r=t.fetchSites,a=t.sites,o=t.isFetchingSites,c=t.pageSize,l=t.pageNumber,s=i||n,u=e&&(e.keywordOverride||e.keyword),d=Object(le.a)(a);!o&&d&&s&&s!==u&&r(s,c,l)},t}(f.Component),Object(T.connect)(Ar,Rr)(Dr)))),Wr=function(){return(Wr=Ji.a||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},zr=function(e){var t=e.className,n=e.domain,i=Object(N.U)(),r=Object(N.t)(),a=Object(bt.d)(),o={className:t,isMainline:!0,renderLoadingState:function(){return f.createElement(rn.a,{isHeroExpanded:!0})},page:"Mainline",scopeContentListLoggerProps:{isAnswer:!0}};switch(Jn.a.startAnswerProfiling(n),n){case"EducationAssignment":return r?f.createElement(fr,Wr({},o)):null;case"File":return f.createElement(Ui,Wr({},o));case"Site":return a?f.createElement(jr,Wr({},o)):f.createElement(Hr,Wr({},o));case"PowerBi":return i?f.createElement(Pr,Wr({},o)):null;case"EmployeeOffer":return f.createElement(kr,Wr({},o));case"Acronym":case"Bookmark":case"Building":case"Calendar":case"CalendarAvailability":case"Connectors":case"EducationClass":case"EnterpriseLearning":case"External":case"FederatedSearch":case"FileEntity":case"FileInferenceAnswer":case"Flight":case"FloorPlan":case"Group":case"Link":case"MeetingRoomProposal":case"Message":case"Notification":case"PeopleAlsoAsk":case"Person":case"Qna":case"QueryReformulation":case"SharePoint":case"Topic":case"Turing":case"TuringQnA":case"VivaQnA":return null;default:return Object(Yt.a)(n)}};function qr(e,t){if(!Object(Et.C)(e)&&!window.BingAtWork.isMainlineAnswerPreExpanded)return!1;if(Object(pt.l)(e))return!0;if(!Object(Et.o)(e))return!1;var n=Object(_.D)(e),i=Object(mt.g)(e),r=Object(mt.f)(e);if(n&&!(i||r)&&!t)return!1;if(!function(e){if(_.ce)return"Low"===Object(mt.b)(e);var t=Object(Et.o)(e);return!t||"Suppress"===t||!Object(_.Rc)(e)&&"Ribbon"===t}(e))return!0;var a=Object(_.nc)(e),o=Object(_.mc)(e),c=Object(mt.b)(e),l=Object(mt.d)(e);if(a)return!o||"Low"!==c||"High"===l;var s=Object(R.g)(e),u=Object(R.i)(e)||Object(R.h)(e)||Object(R.l)(e);return s&&u}var Kr=function(e){var t=Object(Et.o)(e);return!(!t||"RichRibbon"!==t&&"Carousel"!==t)&&("EmployeeOffer"===Object(Et.e)(e)&&Object(_.qc)(e))};var Qr=function(e){var t=Object(pt.d)(e),n=Object(Et.e)(e);return"EnterpriseLearning"===t||"EnterpriseLearning"===n},Ur=function(e){var t=Object(_.zb)(e),n=Object(Zi.j)(e),i=Object(Et.l)(e),r=Object(pt.d)(e);return t&&(i&&"EducationAssignment"===i||r&&"EducationAssignment"===r)?i||r:n||void 0},Vr=function(e){var t=Object(Cn.e)(),n=Object(An.a)(e),i=Object(Zi.t)(e);return Object(pn.i)(e)||i||n||t},Gr=function(e){return!!Object(Zi.O)(e)},Jr=n(778),Yr=O.y,$r=Object(v.a)((function(e){var t=e.palette,n=t.blueMid,i=t.white,r=t.black,a=t.neutralQuaternary,o={content:"''",position:"absolute",top:"0px",right:"-2px",borderBottom:"7px solid transparent",borderTop:"".concat(9,"px solid transparent"),borderLeft:"".concat(9,"px solid ").concat(i),background:r};return Object(E.K)({cardContent:[{position:"static",width:"197px",height:"214px"}],learningImage:[j.f,{maxHeight:"100%",verticalAlign:"middle",display:"inline-block",fontSize:"10px",width:"197px",height:"214px"}],bottomContainer:{position:"absolute",width:"197px",height:"106px",left:"0px",top:"148px",background:r,borderRadius:"0px 0px 6px 6px"},courseTitle:{position:"absolute",width:"165px",height:"40px",left:"16px",bottom:"86px",verticalAlign:"middle",lineHeight:"20px",fontSize:"".concat(13,"px"),color:i,display:"block",overflow:"hidden"},titleContent:{textDecoration:"none",display:"block",verticalAlign:"middle",lineHeight:"20px",fontSize:"".concat(13,"px"),color:e.palette.white},authorAndDuration:[Object(he.r)(e),{position:"absolute",width:"165px",height:"13px",left:"16px",bottom:"65px",textDecoration:"none",display:"block",verticalAlign:"middle",color:a}],domainContent:[Object(he.r)(e),{position:"absolute",width:"87px",height:"13px",left:"16px",bottom:"16px",color:a}],arrowButton:[Object(he.r)(e),{borderRadius:"2px",cursor:"pointer",background:i,fontWeight:"bold",color:n,paddingRight:"10px",alignItems:"center",paddingLeft:"4px",position:"relative",height:"16px",left:"16px",top:"56px",fontSize:"".concat(13,"px"),lineHeight:"13px",marginRight:"4px",selectors:{"::after":[o]}}],tenantLabel:[Object(he.r)(e),{color:i,height:"13px",top:"55px",bottom:"34px",position:"relative",left:"18px"}],bottomGradient:{position:"absolute",height:"40px",left:"0px",right:"0px",bottom:"104px",background:"linear-gradient(180deg, rgba(17, 17, 17, 0.6) 0%, ".concat(r," 100%)"),borderRadius:"0px"},topGradient:{position:"absolute",height:"24px",left:"0px",right:"0px",bottom:"144px",background:"linear-gradient(180deg, rgba(17, 17, 17, 0) 0%, rgba(17, 17, 17, 0.6) 100%)",borderRadius:"0px"}})})),Xr=Object(v.a)((function(e){return Object(E.K)({backgroundImage:{position:"static",width:"197px",height:"148px",background:"url(".concat(e,")"),backgroundSize:"cover"}})})),Zr=n(719),ea=n(1256),ta=n(2647),na=n(2118),ia=n(2019),ra=Object(ta.a)((function(e){if(null==e.children)return null;e.block,e.className;var t=e.as,n=void 0===t?"span":t,i=(e.variant,e.nowrap,Object(ln.__rest)(e,["block","className","as","variant","nowrap"])),r=Object(na.b)(e,{root:n});return Object(na.c)(r.root,Object(ln.__assign)({},Object(ia.h)(i,ia.i)))}),{displayName:"Text",styles:function(e,t){var n=e.as,i=e.className,r=e.block,a=e.nowrap,o=e.variant,c=t.fonts,l=t.semanticColors,s=c[o||"medium"];return{root:[s,{color:s.color||l.bodyText,display:r?"td"===n?"table-cell":"block":"inline",mozOsxFontSmoothing:s.MozOsxFontSmoothing,webkitFontSmoothing:s.WebkitFontSmoothing},a&&{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},i]}}}),aa=n(867),oa=function(e){var t,n=e.course,i=e.onClick,r=e.tenantName,a=e.courseThumbnail,o=n.id,c=n.url,l=n.author,s=n.visualTitle,u=n.duration,d=Object(p.a)(),b=$r(d),m=function(e){if(e){var t=e.split("/")[2].split(".");return t[1].charAt(0).toUpperCase()+t[1].slice(1)}return""}(c),g=(t=l)&&t.length>1?" + "+(t.length-1).toString():"",v=function(e,t){return"popular"===e?Object(aa.g)():!1===t?Object(aa.e)():""}(n.decoration,n.isCoursePaid),h={fontSize:13,fontFamily:Yr},O={fontSize:11,fontFamily:Yr},j=Object(Zr.a)(s,h,165,2,"{0}..."),E=u?100:140,x=Object(Zr.a)(l[0],O,E,1,"{0}..."),S=Object(Zr.a)(r,O,58,1,"{0}..."),C=f.createElement(ra,{className:b.courseTitle},j.text),y=f.createElement(oe.a,{ariaLabel:"Separator",iconName:"LocationDot",title:j.text}),k="popular"===n.decoration?Object(aa.h)({tenantName:S.text}):"",w=u?Object(aa.d)({duration:u}):"",N=f.createElement(ra,{className:b.authorAndDuration},Object(aa.a)()," ",x.text," ",g," ",u&&y," ",w),_=f.createElement(ra,{className:b.domainContent},m),L=f.createElement("div",null,a,f.createElement("div",{className:b.topGradient}),f.createElement("div",{className:b.bottomGradient}),f.createElement("div",{className:b.bottomContainer},C,N,""!==v&&f.createElement("span",{className:b.arrowButton},v),f.createElement("span",{className:b.tenantLabel},k),_));return f.createElement(ea.a,{cardContent:L,width:197,height:254,href:n.url,onClick:i?function(){return i(o)}:void 0})};function ca(e){return Object(pt.b)(e,"EnterpriseLearning",10)}var la=n(907),sa=n(1150),ua=Object(v.a)((function(e){var t;return Object(E.K)({scrollable:{selectors:(t={},t[".".concat(xa)]={overflow:"visible",margin:"0px 8px",top:"4px",background:e.palette.white,borderRadius:"6px",width:"610px",height:"280px"},t[".".concat(la.b)]={lineHeight:0},t[".".concat(sa.a)]={left:"-10px",boxShadow:"0px 2px 3px rgba(0, 0, 0, 0.1)",boxSizing:"border-box",border:Object(de.n)(e)},t[".".concat(sa.b)]={right:"-10px",boxShadow:"0px 2px 3px rgba(0, 0, 0, 0.1)",boxSizing:"border-box",border:Object(de.n)(e)},t)},courseHeading:{width:"608px",height:"22px",marginLeft:"14px",fontSize:"18px",lineHeight:"22px",color:e.palette.neutralDark},LearningCarouselList:{position:"relative",display:"inline-block",height:"254px",overflow:"hidden",whiteSpace:"nowrap",selectors:{">li":{display:"inline-block",marginRight:"3px",marginLeft:"3px"}}}})})),da=n(212),ba=n(117),ma=n(190),pa=n(161);function fa(e){return{key:e}}var ga=Object(pa.a)("LearningImage",(function(e,t){return Object(da.b)(this,void 0,void 0,(function(){var n;return Object(da.c)(this,(function(i){switch(i.label){case 0:return"image",n=e.createRequestUrl("image"),[4,e.makeRequest(n,"POST",t)];case 1:return[2,i.sent()]}}))}))}),!0),va=Object(ba.c)("LearningImageStore",ga);function ha(e,t){var n=e.monitorStarter,i=e.msbRestProvider,r=e.logger,a=function(e,t){return{clientContext:Object(ma.g)(t),Id:e}}(t,e),o={monitorStarter:n,msbRestProvider:i,logger:r,rttName:"EnterpriseLearning_LearningImage_RoundTripTime"},c=fa(t);return Object(ba.a)(ga)(o,c,a)}function Oa(e,t){var n=function(e,t){return va.getSelectors(e).getLatestSuccess(fa(t))}(e,t);return n&&n.bytes}function ja(e){var t=this,n=Object(Ht.a)(),i=Object(T.useDispatch)(),r=Object(T.useSelector)((function(t){return e&&Oa(t,e)})),a=Object(T.useSelector)((function(t){return!!e&&function(e,t){return va.getSelectors(e).isLoading(fa(t))}(t,e)})),o=Object(T.useSelector)((function(t){return!!e&&function(e,t){return va.getSelectors(e).hasError(fa(t))}(t,e)})),c=Object(At.a)(e);return f.useEffect((function(){var l;a||o||r||!e||c===e||(l=e,Object(da.b)(t,void 0,void 0,(function(){return Object(da.c)(this,(function(e){switch(e.label){case 0:return[4,i(ha(n,l))];case 1:return[2,e.sent()]}}))})))}),[a,r,e,c]),Object(In.b)(r)}var Ea=function(e){var t=ja(e.imageId),n=void 0!==t?Xr(t).backgroundImage:void 0;return f.createElement("div",{className:n}," ")},xa="ms-search-tile-card-carousel",Sa=function(e){var t=e.className,n=e.query,i=Object(T.useSelector)((function(e){return ca(e)})),r=Object(Pi.e)(),a=Object(p.a)(),o=Object(J.d)(),c=Object(Mn.d)({entities:i,domain:"EnterpriseLearning",isHero:!0,impressionEventId:"Tile_Carousel_Learning_Impression",clickEventId:"Tile_Carousel_Card_Click",cardType:"Tile",traceId:r,eventScope:"EnterpriseLearning"});if(Object(Yi.a)(i))return null;var l=ua(a),s=function(){return Object(z.a)(i,(function(e,t){var n=function(e){return{id:e.id,url:e.url,visualTitle:e.visualTitle,staticRank:e.staticRank,domainRank:e.domainRank,descriptionSnippet:e.descriptionSnippet,imageId:e.imageId,author:e.author,duration:e.duration,isCoursePaid:e.isCoursePaid,decoration:e.decoration}}(e),i=$r(a).learningImage,r=f.createElement(Ea,{imageId:n.imageId,className:i});return f.createElement("li",{key:t},f.createElement(oa,{course:n,tenantName:o,courseThumbnail:r,onClick:c.entityActions.onEntityClickId}))}))},u=void 0!==n&&f.createElement(ra,{className:l.courseHeading}," ",Object(aa.b)({query:n}));return f.createElement("div",{className:Object(kn.a)(l.scrollable,t)},u,f.createElement(Jr.a,{className:xa,"data-test-id":"LearningCarousel",scrollAnimationDuration:500,carouselType:"HalfBleed",getScrollAmount:Ca,renderCarouselContent:function(e){return f.createElement("ul",{id:e,"aria-label":Object(aa.f)(),className:l.LearningCarouselList},s())},onArrowScrollClick:function(e){c.nonEntityActions.onSearchActionClick("Tile_Carousel_Arrow_Click",{value:e})}}))},Ca=function(e){return 203*Math.floor(e.offsetWidth/203)},ya=n(1250);var ka=Object(ue.b)((function(){return Object(E.K)({container:[be.a,{width:"100%"}],ghostText:{width:"90%",marginLeft:"5%"}})})),wa=function(){var e=ka();return f.createElement(pe.a,{className:e.container,lineClassName:e.ghostText,numLines:3})},Na=function(){return(Na=Ji.a||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},_a=function(e){var t=e.className,n=e.domain;Jn.a.startAnswerProfiling(n);var i=Object(mi.b)(),r=Object(N.y)(),a={className:t,renderLoadingState:function(){return f.createElement(wa,null)},page:"Mainline",query:i};switch(n){case"EmployeeOffer":return f.createElement(ya.a,Na({},a));case"EnterpriseLearning":return r?f.createElement(Sa,Na({},a)):null;case"Acronym":case"Bookmark":case"Building":case"Calendar":case"CalendarAvailability":case"Connectors":case"EducationAssignment":case"EducationClass":case"External":case"FederatedSearch":case"File":case"FileEntity":case"FileInferenceAnswer":case"Flight":case"FloorPlan":case"Group":case"Link":case"MeetingRoomProposal":case"Message":case"Notification":case"PeopleAlsoAsk":case"Person":case"PowerBi":case"Qna":case"QueryReformulation":case"SharePoint":case"Site":case"Topic":case"Turing":case"TuringQnA":case"VivaQnA":return null;default:return Object(Yt.a)(n)}},La=n(284),Ma=n(1665);var Ta=n(535);var Pa=n(1542),Ia=n(2876),Fa=n(775),Aa=n(357),Ra=Object(v.a)((function(){return{hasSolidIcons:!Object(Aa.a)()}})),Ba=Object(v.a)((function(e){return Object(E.K)({root:{height:"16px",padding:"0px",verticalAlign:"top",selectors:{"&:focus":{outline:"3px solid ".concat(e.palette.black)},".ms-Fabric--isFocusVisible &:focus:after":{border:"none",outline:"none"}}},label:[Object(he.r)(e),{color:e.palette.themePrimary,margin:"0px",lineHeight:"16px",selectors:{":hover":{textDecoration:"underline"}}}]})})),Da=function(e){return{buttonLabel:Object(Pa.a)(),buttonStyles:Ba(e),hideIcon:!0}},Ha=function(){var e=Object(T.useSelector)((function(e){return Object(Ta.a)(e,void 0)})),t=Ra(),n=Object(T.useSelector)(_.Yb);return e?f.createElement(Ia.a,{symptomName:e,answerFeedbackStyles:t}):n?f.createElement(Fa.a,{overrideGeneralFeedbackDefaultStyles:Da}):null},Wa=Object(v.a)((function(e,t,n){return Object(E.K)({mainlineFooter:[{float:"right",margin:t?"4px 18px 12px 20px":"8px 20px 12px",whiteSpace:"nowrap"},n?{display:"flex",flexWrap:"wrap",width:"90%",padding:"0px 3px",justifyContent:"flex-end"}:void 0],privacyContainer:{backgroundClip:"padding-box",height:"14px",paddingTop:"9px",paddingBottom:"9px",width:"100%",color:e.palette.neutralPrimary},privacyMessage:[Object(he.r)(e),{display:"inline-block",lineHeight:t?"16px":"13px",verticalAlign:t?"top":"unset"}],feedback:{display:"inline-block",marginLeft:"4px",selectors:{"> div > a":[e.fonts.tiny,{display:"inline-block"}]}},dotSeparator:{lineHeight:"16px",display:"inline-block",verticalAlign:"top",marginLeft:"4px",color:e.palette.blackTranslucent40,fontSize:"13px"}})})),za=n(247),qa=n(1986),Ka=(Object(Bn.declareString)("search-hostapp-msb-mainline.search.shared.seeAllResults")),Qa=(Object(Bn.declareStringWithPlaceholders)("search-hostapp-msb-mainline.search.shared.seeAllResultsFrom")),Ua=(Object(Bn.declareStringWithPlaceholders)("search-hostapp-msb-mainline.search.shared.seeMoreDomainEntitiesFrom")),Va=(Object(Bn.declareString)("search-hostapp-msb-mainline.search.shared.signedIntoWork")),Ga=(Object(Bn.declareString)("search-hostapp-msb-mainline.search.shared.signedIntoEdu")),Ja=(Object(Bn.declareString)("search-hostapp-msb-mainline.search.shared.signedIn")),Ya=(Object(Bn.declareString)("search-hostapp-msb-mainline.search.shared.signOut")),$a=Object(v.a)((function(e,t,n){return Object(E.K)({buttonWithIcon:{height:"calc(100% - ".concat("12px",")"),width:"calc(100% - ".concat("24px",")"),paddingTop:"12px",paddingLeft:"24px",selectors:{":focus":{textDecoration:"underline",outlineOffset:"-1px"}}},footerContent:{overflow:"hidden",borderRadius:"0 0 ".concat(ve.a," ").concat(ve.a),backgroundColor:n?e.palette.white:t?t.color:e.palette.neutralPrimary,height:"40px",borderTop:n?"1px solid ".concat(e.palette.neutralLight):void 0,selectors:{"span,i":{fontWeight:n?E.g.bold:E.g.regular,color:n?e.palette.themePrimary:e.palette.white},":hover span":{textDecoration:n?"underline":void 0}}}})})),Xa=function(){return(Xa=Ji.a||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},Za=function(e){var t=e.className,n=e.onSeeMoreResultsClick,i=e.footerLinkDomain,r=Object(p.a)(),a=Object(za.b)(),o=Object(J.d)(),c=Object(w.n)(),l=Object(N.t)(),s=Object(T.useSelector)(_.M),u=Object(fn.d)(),d=Object(w.x)().buildBingWorkVerticalUrl,b=$a(r,a,s),m=i&&Object(Hn.a)(i),g=Object(T.useSelector)(Vr),v=Object(T.useSelector)(Zi.u),h=Object(T.useSelector)(Gr),O=m&&!h?Ua({domainEntities:m.toLocaleLowerCase(),tenantName:o}):Qa({resultSource:g}),j=c?"ChevronLeftIcon":"ChevronRightIcon",E=Object(T.useSelector)((function(e){return Object(Zi.A)(e,"Connectors")})),x=l?"MSBEFT":qa.c;return f.createElement("div",{className:Object(kn.a)(t,b.footerContent),id:"b_bfb-footerContent"},u&&f.createElement(xn.a,{className:b.buttonWithIcon,iconName:j,text:O,url:d&&d(Xa(Xa({},u),{normalizedQuery:E}),i,x,v),onClick:n,target:"_self"}))},eo=n(487),to=Object(v.a)((function(e,t,n){return Object(E.K)({workResultIndicator:{display:"flex",flexDirection:"row",alignItems:"center",padding:"0px 8px",position:"absolute",width:"auto",height:"24px",backgroundColor:"".concat(t),border:"none",color:e.palette.black,textDecoration:"none",borderRadius:"12px"},workResultIndicatorText:{position:"static",fontFamily:"Roboto",fontStyle:"normal",fontWeight:"normal",fontSize:"13px",lineHeight:"16px",padding:"4px 0px 4px 8px",color:"".concat(n)},iconLock:[Ue.a,{width:"10px",padding:"6px 0px",color:"".concat(n)}]})})),no=function(e){var t=e.className,n=e.iconName,i=e.indicatorColor,r=e.indicatorTextColor,a=Object(p.a)(),o=to(a,i,r),c=f.createElement(oe.a,{className:o.iconLock,iconName:n});return f.createElement("div",null,f.createElement("button",{"aria-label":Object(Cn.J)(),className:Object(kn.a)(o.workResultIndicator,t)},c,f.createElement("span",{className:o.workResultIndicatorText},Object(Cn.J)())))},io=n(479),ro=n(940),ao=Object(ue.b)((function(e,t,n,i){var r,a,o,c;return Object(E.K)({headerRow:{display:"flex",height:"".concat(n?48:60,"px"),paddingLeft:"20px",backgroundColor:n?i:t.palette.white,borderTopLeftRadius:n?ve.a:void 0,borderTopRightRadius:n?ve.a:void 0,selectors:(r={},r[E.h]={"-ms-high-contrast-adjust":"none","forced-color-adjust":"none"},r)},masthead:{maxWidth:"400px",selectors:(a={},a[".".concat(V.a)]={maxWidth:"360px"},a)},headerRowRight:{display:"inline-block",verticalAlign:"middle",float:"right",marginTop:"12px",paddingLeft:"".concat(20,"px"),paddingRight:"".concat(13,"px"),marginLeft:"auto",height:"100%",selectors:(o={"> div":{display:"inline-block"}},o[E.h]={"-ms-high-contrast-adjust":"none","forced-color-adjust":"auto"},o)},persona:{display:"inline-block",cursor:"pointer",selectors:(c={":not(:first-child)":{marginLeft:"16px"}},c[".".concat(qn.a," > div")]=e?{top:"-4px"}:void 0,c)},headerRowNotification:{marginRight:"20px",verticalAlign:"top"},workResultIndicator:{marginTop:"12px",marginLeft:"30px"}})})),oo=n(647),co=function(e){var t=e.onSignOutClick,n=e.customButton,i=e.className,r=e.buttonClassName,a=e.ariaLabel,o=e.setVisibility,c=f.useRef(null),l="orgid/signout?ru=".concat(encodeURIComponent(window.location.href));return f.createElement("form",{ref:c,action:l,method:"post",className:i},f.createElement("button",{role:"link",onClick:function(){t();var e=c.current;e&&e.submit()},className:r,onBlur:function(){o&&o(!1)},"aria-label":a},n))},lo=n(2057),so=Object(v.a)((function(e,t){return Object(E.K)({signOutMenu:{whiteSpace:"nowrap"},profilePhoto:{marginLeft:"".concat("7px")},userEmail:[Object(O.n)(e),{margin:t?"5px":"".concat("3px"," ").concat("7px")}],signOut:{margin:t?"0 0 0 auto":"".concat("3px"," 0 ").concat("3px"," auto")},signOutButton:[Object(O.n)(e),Object(he.q)(e),lo.h,{background:"none",margin:"0",padding:t?"5px 15px":"1px 6px",border:t?Object(de.k)(e):"none",borderRadius:t?"15px":void 0}],title:[Object(O.m)(e),{margin:"".concat("3px"," ").concat("7px")}],description:[Object(he.j)(e),{margin:"".concat("3px"," ").concat("7px")}],learnMorePrivacyLink:[Object(he.q)(e),j.d,{margin:"7px ".concat("7px")}],topContent:{padding:t?"15px ".concat("12px"," 5px ").concat("12px"):void 0,display:t?"block":"flex",alignItems:t?void 0:"center"},bottomContent:{padding:"10px ".concat("12px"),borderTop:Object(de.k)(e),display:"flex",alignItems:"center"}})})),uo=function(e){var t=e.description,n=e.className,i=e.isFullVersion,r=e.onSignOutClick,a=e.setVisibility,o=Object(p.a)(),c=Object(X.a)(),l=Object(X.c)(),s=Object(X.d)(),u=Object(k.a)(),d=Object(w.b)(),b=Object(J.d)(),m=so(o,i),g=f.createElement(f.Fragment,null,f.createElement("div",{className:m.topContent},f.createElement("div",{className:m.userEmail},s),f.createElement(co,{customButton:Ya(),onSignOutClick:r,className:m.signOut,buttonClassName:m.signOutButton,setVisibility:a,ariaLabel:Ya()})),f.createElement("div",{className:m.description},f.createElement("span",null,t))),v=c&&l&&f.createElement(Z.a,{fullName:c,photoId:l,size:ae.c.size24,className:m.profilePhoto}),h=f.createElement(f.Fragment,null,f.createElement("div",{className:m.topContent},f.createElement("div",{className:m.title},Object(Cn.G)({tenantName:b})),f.createElement("div",{className:m.description},f.createElement("span",null,t)),f.createElement("div",{className:m.learnMorePrivacyLink},f.createElement(oo.a,{text:Object(Cn.i)(),onClick:function(){Object(re.o)(u,"Learn_More_Click",{clientSize:d,eventScope:"Page"})}}))),f.createElement("div",{className:m.bottomContent},v,f.createElement("div",{className:m.userEmail},s),f.createElement(co,{customButton:Ya(),onSignOutClick:r,className:m.signOut,buttonClassName:m.signOutButton,setVisibility:a,ariaLabel:Ya()})));return f.createElement("div",{className:Object(kn.a)(m.signOutMenu,n)},i?h:g)},bo=function(e){var t=e.onProfilePictureClick,n=e.onSignOutClick,i=e.hideTeaser,r=Object(w.q)(),a=Object(N.t)(),o=Object(N.kb)(),c=Object(p.a)(),l=Object(T.useSelector)(_.M),s=Object(Y.b)(),u=Object(Y.e)(),d=l?48:60,b=ao(r,c,l,s),m=f.createElement(io.a,{className:b.persona,size:ae.c.size24}),g=a?Ga():Va(),v=f.createElement(eo.a,{isSmall:!1,buttonId:"b_bfb-signOutButton",customButton:m,renderInfoButtonContent:function(e,t){return f.createElement(uo,{description:g,onSignOutClick:n,setVisibility:t})},showInfoBubbleOnHover:!0,onClick:t,ariaLabel:Ja()}),h=f.createElement(De.a,{codeLocation:"MainlineFirstRunNotificationContainer.Bing"},f.createElement(Vt,{profileButton:v,hideTeaser:i})),O=o&&f.createElement(no,{className:b.workResultIndicator,indicatorColor:u,indicatorTextColor:s,iconName:"LockSolid"});return f.createElement("div",{className:b.headerRow},f.createElement(ro.a,{isPrivacyMessageEnabled:!1,className:b.masthead,selectedHeight:d}),O,f.createElement("div",{className:b.headerRowRight},h))},mo=function(e){var t=e.showFrameHeader,n=e.showFrameFooter,i=e.showPrivacyContainer,r=e.customizeFooter,a=e.children,o=e.notification,c=e.footerLinkDomain,l=e.hideTeaser,s=e.hideFeedbackButton,u=Object(p.a)(),d=Object(k.a)(),b=Object(w.b)(),m=Object(Ot.a)(),g=Object(T.useSelector)(N.D),v=Object(T.useSelector)($t.d),h=Object(T.useSelector)($t.c),O=Object(N.t)(),j=Object(N.kb)(),E=Object(T.useSelector)(pt.d),x=Object(At.a)(m),S=function(){var e=Object(T.useSelector)(Jt),t=Object(T.useSelector)(_.R),n=Object(T.useSelector)(_.Yb),i=Object(w.b)();return(Object(T.useSelector)((function(e){return Object(Ta.a)(e,void 0)}))&&!e&&t||n)&&"Small"!==i||!1}(),C=Object(J.d)(),y=Object(Ot.e)(),L=Wa(u,S,y),P=Object(G.c)(E),I=Object(N.f)(),F=Object(bt.d)(),A=g&&"Low"===m,R=h&&v&&A?"High":m,B=Object(bi.b)(Object(bi.a)(R),I||"Low"===R);f.useEffect((function(){(R&&!x&&n&&!F&&!A||v&&A)&&(Object(ye.q)(d,b,R,o),Object(M.a)(d,Object(bi.a)(R),"MainlineFrameImpression"),A||!I&&"Low"!==R||B.logImpression())}),[d,b,R,x,o,F,A,v]);var D=f.createElement("div",{className:L.feedback},S&&f.createElement(Ha,null)),H=f.createElement(f.Fragment,null,f.createElement(Ma.a,{className:L.privacyMessage,isMessageSmall:!!y}),S&&f.createElement("div",{className:L.dotSeparator},f.createElement(La.a,{isLarge:!0}))),W=r?f.createElement(f.Fragment,null,r):i?f.createElement(f.Fragment,null,D):f.createElement(f.Fragment,null,H,D);return f.createElement(f.Fragment,null,t&&f.createElement(bo,{onProfilePictureClick:function(){return Object(re.b)(d,b)},onSignOutClick:function(){return function(e,t){Object(re.e)(e,t);var n={clientSize:t,eventScope:"Mainline"};Object(Pt.H)(e,{eventId:"Mainline_Sign_Out",properties:n})}(d,b)},hideTeaser:l}),i&&f.createElement(U.b,{className:L.privacyContainer,tenantName:C,onClickLogger:function(){Object(re.o)(d,"Learn_More_Click",{clientSize:b,eventScope:"Page"})},isEduEnabled:O,isWorkWebDifferentiationEnabled:j,workResultString:P}),a,n&&f.createElement(Za,{onSeeMoreResultsClick:function(){I||"Low"===R?B.logClick():Object(re.d)(d,b,R,o)},footerLinkDomain:c}),!s&&f.createElement("div",{className:L.mainlineFooter},W))},po=function(){var e=Object(T.useSelector)(Et.l),t=Object(T.useSelector)(Jt),n=Object(T.useSelector)(Et.n),i=Object(Dt.b)(),r=Object(bt.b)(),a=Object(T.useSelector)(Qr),o=f.createElement("div",{className:tc},void 0===e&&r&&"EducationAssignment"===r?f.createElement(zr,{domain:r,conversationProvenance:t}):e&&"Connectors"!==e?f.createElement(zr,{domain:e,conversationProvenance:t}):n?f.createElement(_a,{domain:n}):f.createElement(lr,null)),c=Object(T.useSelector)(Ur),l=Object(Ot.e)();return i?f.createElement(mo,{showFrameHeader:!1,showPrivacyContainer:!0,showFrameFooter:!1},f.createElement(De.a,{codeLocation:"TourContainer.Bing"},f.createElement(Bt.a,{notificationKind:"MainlineFirstRun"}))):a?f.createElement(mo,{showFrameHeader:!1,showPrivacyContainer:!1,showFrameFooter:!1,hideFeedbackButton:!0},o):f.createElement(mo,{showFrameHeader:!0,showPrivacyContainer:!0,showFrameFooter:!l,footerLinkDomain:c},o)},fo=function(){return Promise.all([n.e(4),n.e(154)]).then(n.bind(null,2865)).then((function(e){return{default:e.NoConfidentNotification}}))},go=function(e){return Object(zt.b)(fo,{chunkName:"serpfre"},Object(k.a)())(e)},vo=function(e){var t=e.onDismiss,n=Object(k.a)(),i=Object(T.useDispatch)(),r=Object(Ht.a)(),a=Object(w.b)(),o=Object(w.q)(),c=Object(w.j)(),l=Object(Ii.a)().requery,s=Object(T.useSelector)(P.s),u=Object(X.b)(),d=Object(J.d)(),b=Object(B.a)("NoConfident"),m=b.hasNotificationKind,p=b.notificationConfig,g=Object(B.a)("MainlineRetentionGleam").hasNotificationKind,v=m||g,h=g?"MainlineRetentionGleam":"NoConfident",O=Object(D.a)(h,"NoConfidentNotificationContainer",void 0,!0),j=O.logImpression,E=O.logEngagementClick,x=O.logDismissClick,S=Object(Dt.a)(),C=r.searchOptions,y=C.buildBingWorkVerticalUrl,N=C.initialSearchQuery;if(f.useEffect((function(){v&&S&&(p&&Object(M.b)(n,p,"Impression"),j())}),[v,S]),!v||!N)return null;return f.createElement(go,{notificationCampaign:null==p?void 0:p.notificationCampaign,isMobile:"Small"===a&&!o&&!c,requeryStrings:null==p?void 0:p.requeryStrings,isFREV2:s,onDismiss:function(){t(),x()},onRequeryClick:function(e,t,n){E(),y?window.location.href=y({query:t}):l(e,t,n)},onLearnMoreClick:function(){i(Object(Wt.a)({isTourOpen:!0})),E()},logEngagementClick:E,tenantDisplayName:d,userGivenName:u,titleContent:null==p?void 0:p.titleContent,query:N,personaPart:f.createElement(io.a,{size:ae.c.size48})})},ho=n(285),Oo=n(2381),jo=n(931),Eo=n(229),xo=Object(ue.b)((function(){return Object(E.K)({icon:{marginLeft:"20px",marginRight:"10px",marginBottom:"10px"},welcomeHeader:{display:"flex"},headerTitle:{fontFamily:O.w,fontSize:"18px",lineHeight:"22px",fontStyle:"normal",fontWeight:"400",color:"#111111"},headerSubTitle:{fontSize:"14px",fontWeight:"400",lineHeight:"22px",color:"#666666"},pill:{marginLeft:"58px"},pillContainer:{width:"max-content",padding:"0px 20px",marginLeft:"40px"},pillCarousel:{marginBottom:"20px"}})})),So="EducationClass",Co="EducationConversation",yo="MainlineEducationProfilePill",ko=function(e){var t=e.onShown,n=Object(T.useSelector)(Eo.c),i=Object(T.useSelector)(Eo.d),r=Object(N.s)(),a=Object(N.r)(),o=Object(T.useSelector)(_.wb),c=xo(),l=Object(X.b)();f.useEffect((function(){t&&t()}),[]);var s=Object(T.useSelector)(Eo.e);if(o&&!s)return f.createElement(f.Fragment,null);var u=a?n&&i?["EducationAssignment",So,Co]:i?[So,Co,yo]:r?[Co,"MainlineEducationFilePill",yo]:[Co,yo,"MainlineEducationCalendarPill"]:n&&i||!o?["EducationAssignment",So,Co]:i||!o?[So,Co]:[Co],d=f.createElement(jo.a,{pills:u,generalPillProps:{v2:a,useCompactStyling:!0}}),m=f.createElement("div",{className:c.icon},f.createElement(io.a,{size:ae.c.size48})),p=f.createElement("div",null,f.createElement("div",{className:c.headerTitle},Object(g.f)(Object(b.w)(),l)),f.createElement("div",{className:c.headerSubTitle},Object(b.r)()));return f.createElement(f.Fragment,null,f.createElement("div",{className:c.welcomeHeader},m,p),f.createElement("div",{className:c.pillCarousel},f.createElement(Oo.a,{width:ho.a},f.createElement("div",{className:c.pillContainer},d))))},wo=Object(v.a)((function(e){return Object(E.K)({scrollable:{paddingTop:e?"12px":void 0}})})),No=n(339),_o=n(1244),Lo=Object(v.a)((function(e){var t,n,i;return Object(E.K)({mainlinePillListContainer:{whiteSpace:"nowrap",selectors:(t={},t[".".concat("ms-search-mainlinePill",":first-child")]={marginLeft:"".concat(20,"px")},t[".".concat("ms-search-mainlinePill",":not(:first-child)")]={marginLeft:"8px"},t[".".concat("ms-search-mainlinePill",":last-child")]={marginRight:"".concat(20,"px")},t[".".concat(_o.a,":hover, .").concat("ms-search-mainlinePillFrame",":hover")]={borderColor:e.palette.neutralTertiary,boxShadow:"0px 2px 3px rgba(0, 0, 0, 0.1)"},t)},mainlinePillFrame:["ms-search-mainlinePillFrame",Object(he.q)(e),{display:"inline-block",verticalAlign:"middle",overflow:"hidden",textOverflow:"ellipses",padding:"0 10px",height:"50px",selectors:(n={i:{verticalAlign:"middle",marginTop:"-3px",color:e.palette.themePrimary},a:{color:e.palette.themePrimary,textDecoration:"none"}},n["&.".concat(No.b)]={lineHeight:"50px"},n)}],mainlinePill:["ms-search-mainlinePill",{verticalAlign:"middle",display:"inline-block",marginBottom:"12px",selectors:{a:{display:"inline-block"}}}],smallPill:{selectors:(i={},i[".".concat(No.a)]={width:"70px"},i)}})})),Mo=function(){var e=Object(k.a)(),t=Object(T.useSelector)(_.M),n=Object(p.a)(),i=H(),r=i.activeNotificationKind,a=i.activeNotificationConfig,o=wo(t),c=Lo(n),l=Object(D.a)(r,"MainlineEduDiscoverabilityContainer",void 0,!0),s="DiscoverabilityPillFre"===r;return f.createElement(mo,{showFrameHeader:!0,showPrivacyContainer:!0,showFrameFooter:!1,hideTeaser:!0},f.createElement("div",{className:o.scrollable},f.createElement(ko,{onShown:function(){a&&Object(M.b)(e,a,"Impression"),l.logImpression()},containerStyles:c.mainlinePillListContainer,pillStyles:c.mainlinePill,isFre:s})))},To=function(){var e=Object(B.a)("NoConfident").hasNotificationKind,t=Object(B.a)("MainlineRetentionGleam").hasNotificationKind,n=Object(T.useSelector)(mt.c);n=n||"Pole";var i=Object(T.useSelector)(mt.b),r=Object(Dt.b)(),a=Object(N.H)(),o=Object(N.t)(),c=Object(B.a)("ScopeTabOverlay").hasNotificationKind,l=H().isEnabled;lt(n);var s=function(){st(n,!1,i)};if(e||t){var u=f.createElement(mo,{showFrameHeader:!1,showPrivacyContainer:!1,showFrameFooter:!1,notification:"NoConfident"},f.createElement(De.a,{codeLocation:"TourContainer.Bing"},f.createElement(Bt.a,{notificationKind:"NoConfident",onDismiss:s})));return ut(),r?u:f.createElement(mo,{showFrameHeader:!0,showPrivacyContainer:!1,showFrameFooter:!1,notification:"NoConfident",hideTeaser:a},f.createElement(De.a,{codeLocation:"NoConfidentNotificationContainer.Bing"},f.createElement(vo,{onDismiss:s})))}return o&&l?(ut(),f.createElement(Mo,null)):(c||st(),null)},Po=n(1377),Io=Object(ue.b)((function(e){return Object(E.K)({container:[be.a,Object(No.h)(e),yn.a,{backgroundColor:e.palette.neutralLight}]})})),Fo=Object(se.a)((function(e){var t=Io(e.theme);return f.createElement("div",{className:Object(kn.a)(e.className,t.container)})})),Ao=n(906),Ro=n(532),Bo=n(905),Do=n(1098),Ho=function(e){var t=Object(Do.a)(),n=e.className;return f.createElement("div",{className:Object(kn.a)(t.container,n),"aria-hidden":!0},Object(Cn.q)())},Wo=n(290),zo=n(2569),qo=(Object(Bn.declareStringWithPlaceholders)("search-hostapp.search.scopeSummaryPillContainer.countWithPlus")),Ko=(Object(Bn.declareStringWithPlaceholders)("search-hostapp.search.scopeSummaryPillContainer.domainCountSummaryStr"));function Qo(e){return 0===e.domainResultsCount}function Uo(e){return!(e.isLoading||Qo(e))}function Vo(e,t,n,i,r,a){return function(e){switch(e){case"Acronym":case"EmployeeOffer":return!0;case"Bookmark":case"Building":case"Calendar":case"CalendarAvailability":case"Connectors":case"EducationAssignment":case"EducationClass":case"EnterpriseLearning":case"External":case"FederatedSearch":case"File":case"FileEntity":case"FileInferenceAnswer":case"Flight":case"FloorPlan":case"Group":case"Link":case"MeetingRoomProposal":case"Message":case"Notification":case"PeopleAlsoAsk":case"Person":case"PowerBi":case"Qna":case"QueryReformulation":case"SharePoint":case"Site":case"Topic":case"Turing":case"TuringQnA":case"VivaQnA":return!1;default:return Object(Yt.a)(e)}}(e)&&n&&e?function(e,t,n,i,r,a){var o={fontSize:No.d,fontFamily:t.fonts.small.fontFamily||O.y},c=r&&function(e,t,n){switch(e){case"EmployeeOffer":var i=void 0!==n?n+1:0;return t-(i||1)>0?Object(Cn.o)({count:(t-i).toString()}):void 0;case"Acronym":return t>1?(t-1).toString():void 0;default:return t.toString()}}(e,r,a),l=function(e){switch(e){case"EmployeeOffer":case"Acronym":return!1;default:return!0}}(e),s=Object(Zr.b)(n,o),u=function(e,t,n){var i=125-n,r=250;"EmployeeOffer"===e&&(r=180);var a=r-t;return a>i?a:i}(e,s,c?Object(Zr.b)(c,o):0),d=Object(Zr.c)(n,u,o,Object(Cn.f)());return f.createElement(f.Fragment,null,l&&f.createElement("span",null,Object(Hn.a)(e)),l&&f.createElement(La.a,{className:i,isLarge:!0}),f.createElement("span",null,d.text),r&&!!c&&f.createElement(f.Fragment,null,f.createElement(Ho,{className:i}),f.createElement("span",null,c)))}(e,t,n,i,r,a):void 0}var Go=Object(T.connect)((function(e,t){var n=t.domain,i=t.conversationProvenance,r=t.candidatePills,a=t.domainResultsCount,o=Object(_.g)(e);return{isSelected:"Small"===o&&Object(Fn.q)(e,n),isAnyScopeCardSelected:"Small"===o&&!!Object(Fn.b)(e),isLoading:Object(zo.e)(n)&&Object(Et.D)(e),domainResultsCount:a||Object(Et.c)(e,n,void 0,void 0,i,Ro.a),domainTitle:Object(Et.q)(e,n),domainSubTitle:Object(Et.p)(e,n,null==r?void 0:r.length)}}),(function(e,t){return{toggleSelectScopeCardAction:function(n){var i=t.domain,r=t.conversationProvenance;e(Object(Tn.p)({source:"UserExplicit",selectedScopeCardDomain:n?i:void 0,selectedConversationProvenance:r}))},selectHeroDomainAction:function(t){e(Object(Wo.d)({domain:t,resultId:void 0,hideHero:!0}))}}}))((function(e){var t=e.isLoading,n=e.domainTitle,i=e.domainSubTitle,r=e.className,a=e.domain,o=e.domainResultsCount,c=e.conversationProvenance,l=e.isSelected,s=e.isAnyScopeCardSelected,u=e.toggleSelectScopeCardAction,d=e.selectHeroDomain,b=e.selectHeroDomainAction,m=e.onPillShown,g=e.noToggle,v=e.candidatePills,h=e.impressionEventId,O=e.groupClickEventId,j=e.canaditeResults,E=e.href,x=e.title,S=e.iconName,C=e.entitiesCount,y=e.groupReferenceId,k=(null==v?void 0:v.length)||(null==j?void 0:j.length),N=Object(w.b)(),_=Object(In.g)({clientSize:N}),L=Object(w.q)(),M=Object(p.a)(),P=Object(za.b)(),I=Object(T.useSelector)(Zi.r),F=P&&P.color||M.palette.themePrimary,A=C?C>0:void 0,R=Object(Mn.d)({entities:v||j,domain:a,isHero:!1,impressionEventId:h,cardType:"Pill",groupReferenceId:y,layoutProps:{name:"PillList",childPlacementType:"Hidden"},hasItems:A,completedLoading:A}),B="Turing"===a?.8:void 0,D=Object(_o.b)(_,B),H=Object(Rn.d)(a,o,"List",!1,!1),W=H.shownCount,z=H.showSeeMoreLink,q=Object(At.a)(e);f.useEffect((function(){q&&Uo(q)||!Uo(e)||!m||m(a)}),[q,m,a,e]);if(t)return f.createElement(Fo,{className:Object(kn.a)(r,D.ghostPill)});if(Qo(e))return null;var K,Q,U,V=x||(n||Object(Hn.a)(a,c,void 0,I)),G=i||(K=z,Q=String(W),U=K?qo({count:Q}):Q,Ko({countWithOptionalPlus:U}));if(!V)return null;var J=!E,Y={primaryText:V,secondaryText:G,secondaryContent:Vo(a,M,G,D.splitterClassName,W,k),isSelected:l,isSmall:_,tenantThemeColor:F,iconName:S||Object(Rn.c)(a),iconColor:Object(Rn.b)(a),className:Object(kn.a)(r,D.scopePillFrame),isTabStopDisabled:s&&!l&&!L,onClick:function(){g||(u(!l),d&&b(a)),R.nonEntityActions.onSearchActionClick(O)},href:E,isRoleTab:J,shouldRenderButton:!1};return f.createElement(Bo.a,Object(ln.__assign)({},Y))})),Jo=function(){var e,t=Object(Ht.a)().searchOptions.buildBingWorkVerticalUrl,n=Object(w.b)(),i=Object(k.a)(),r=Object(mi.b)(),a=Object(mi.c)(),o=Object(p.a)(),c=Object(T.useSelector)(Et.K),l=f.useRef(Object(Po.a)()),s=Object(T.useSelector)(_.Nd);Object(vr.a)({pageNumber:mn.b,pageSize:mn.d,showResultCluster:!1,aggregations:void 0,refiningQueries:void 0,isEnabled:!0,isSerpUsingSubstrateUnifiedSearch:!1,isNLFileSearchEnabled:!1,isTuringMarkerEnabled:s});var u=Object(T.useSelector)((function(e){return Object(di.a)(e)})),d=wt(c,!1,u,void 0),b=d.shownCandidates,m=d.shownDomainResultsCount,g=Nt(b,m),v=Lo(o),h=Object(T.useSelector)((function(e){return Object(mt.c)(e)})),O=Object(T.useSelector)(mt.b),j=Object(T.useSelector)(di.m),E=Object(N.f)(),x=Object(bi.b)(Object(bi.a)("Medium"),E),S=f.useState(!1),C=S[0],y=S[1],L=f.useState(!1),P=L[0],I=L[1];f.useEffect((function(){i&&(P||(Object(M.a)(i,Object(bi.a)("Medium"),"MainlineMiniWorkScopePillListContainerImpression"),I(!0)),x&&n&&!C&&E&&(Object(ye.q)(i,n,"Medium"),x.logImpression(),y(!0)))}),[i,x,n,E,P]);if(j)return f.createElement(Fo,null);if(m&&m[0]&&0===(null===(e=m[0].candidates)||void 0===e?void 0:e.length))return st(h=h||"Pole",void 0,O),f.createElement(f.Fragment,null);var F=Object(z.a)(m,(function(e,t){var n;if(r)return f.createElement("div",{className:v.mainlinePill,key:t},f.createElement(Go,{domain:e.domain,selectHeroDomain:!0,impressionEventId:"Mainline_Pill_Impression",groupClickEventId:"Mainline_Pill_Click",groupReferenceId:l.current,noToggle:!1,index:t,candidatePills:e.candidates,domainResultsCount:null===(n=null==e?void 0:e.candidates)||void 0===n?void 0:n.length,title:r,iconName:Ne.I}))})),A=a&&f.createElement(Ao.a,{text:Ka(),url:t&&t({query:a},void 0,qa.d),className:Object(kn.a)(v.mainlinePillFrame,v.mainlinePill),onClick:function(){E?x.logClick():Object(re.d)(i,n,"Medium")}});return g&&r?f.createElement("div",{className:v.mainlinePillListContainer},F,A):null};var Yo=n(1177),$o=n(1646),Xo=function(){var e=Object(w.b)(),t=Object(k.a)(),n=Object(mi.b)(),i=Object(mi.c)(),r=Object(p.a)(),a=Object(T.useSelector)(Et.K),o=Object(T.useSelector)(_.eb),c=function(e){return Object(T.useSelector)((function(t){return Object(Et.a)(t,e)}))}(e),l=f.useRef(Object(Po.a)()),s=Object(T.useSelector)((function(e){return Object(Et.e)(e)})),u=Lt(s),d=Object(T.useSelector)((function(e){return Object(Et.s)(e,u)})),b=Object(w.x)().buildBingWorkVerticalUrl,m=_t(s),g=wt(a,!1,c,d,m,o),v=g.shownCandidates,h=g.shownDomainResultsCount,O=Nt(v,h),j=Lo(r),E=m?j.smallPill:void 0,x=Object(Yo.a)(),S=Object(N.f)(),C=Object(bi.b)(Object(bi.a)("Medium"),S),y=f.useState(!1),L=y[0],P=y[1],I=f.useState(!1),F=I[0],A=I[1],R=v&&Object(z.a)(v.candidates,(function(e,t){return f.createElement("div",{className:j.mainlinePill,key:t},f.createElement($o.a,{domain:v.domain,position:1,candidate:e,impressionEventId:"Mainline_RichPill_Impression",clickEventId:"Mainline_RichPill_Click",groupReferenceId:l.current,className:E,index:t,onCandidateClick:function(e){x(v.domain,e)}}))})),B=Object(z.a)(h,(function(e,t){var i;if(n)return!Tt(e.domain,o)||!e.candidates||v&&v.domain===e.domain?!Tt(e.domain,o)&&f.createElement("div",{className:j.mainlinePill,key:t},f.createElement(Go,{domain:e.domain,selectHeroDomain:!0,impressionEventId:"Mainline_Pill_Impression",groupClickEventId:"Mainline_Pill_Click",groupReferenceId:l.current,noToggle:!0,index:t,candidatePills:e.candidates,entitiesCount:null===(i=e.candidates)||void 0===i?void 0:i.length,href:b&&b({query:n},e.domain)})):f.createElement("div",{className:j.mainlinePill,key:t},f.createElement($o.a,{domain:e.domain,position:1,candidate:e.candidates[0],impressionEventId:"Mainline_RichPill_Impression",clickEventId:"Mainline_RichPill_Click",className:E,groupReferenceId:l.current,index:t,onCandidateClick:function(t){x(e.domain,t)}}))}));f.useEffect((function(){t&&(F||(Object(M.a)(t,Object(bi.a)("Medium"),"MainlineScopePillListContainerImpression"),A(!0)),C&&e&&!L&&S&&(Object(ye.q)(t,e,"Medium"),C.logImpression(),P(!0)))}),[t,C,e,S]);var D=i&&f.createElement(Ao.a,{text:Ka(),url:b&&b({query:i},void 0,qa.d),className:Object(kn.a)(j.mainlinePillFrame,j.mainlinePill),onClick:function(){S?C.logClick():Object(re.d)(t,e,"Medium")}});return O&&n?f.createElement("div",{className:j.mainlinePillListContainer},R,B,D):null},Zo=function(){var e=Object(Dt.b)(),t=Object(T.useSelector)(_.M),n=Object(bt.d)(),i=Object(T.useSelector)(Qr),r=wo(t),a=f.createElement("div",{className:r.scrollable},f.createElement(Jr.a,{className:"ms-search-mainlineCarousel",carouselType:"HalfBleed",scrollAnimationDuration:1e3,renderCarouselContent:function(e){return f.createElement("div",{id:e},n?f.createElement(Jo,null):f.createElement(Xo,null))},minScrollDistance:20,scrollAmount:100,scrollArrowTopPosition:8}));return e?f.createElement(mo,{showFrameHeader:!1,showPrivacyContainer:!0,showFrameFooter:!1},f.createElement(De.a,{codeLocation:"TourContainer.Bing"},f.createElement(Bt.a,{notificationKind:"MainlineFirstRun"}))):i?f.createElement(mo,{showFrameHeader:!1,showPrivacyContainer:!1,showFrameFooter:!1,hideFeedbackButton:!0},f.createElement(_a,{domain:"EnterpriseLearning"})):f.createElement(mo,{showFrameHeader:!0,showPrivacyContainer:!0,showFrameFooter:!1},a)},ec=function(){return f.createElement(mo,{showFrameHeader:!0,showPrivacyContainer:!0,showFrameFooter:!0,footerLinkDomain:"File"},f.createElement("div",{className:tc},f.createElement(lr,null)))},tc="ms-search-noOverflowContent",nc=function(){var e=Object(A.b)(),t=Object(A.a)(),n=Object(N.D)(),i=n&&t;return e?f.createElement(Zo,null):t&&!n?f.createElement(To,null):i?f.createElement(ec,null):f.createElement(po,null)},ic=n(1497),rc=n(417),ac=Object(v.a)((function(e,t,n){var i,r,a;return Object(E.K)({mainlineContainer:[Object(de.f)(e),"ms-search-ribbon",n?{marginBottom:"20px"}:void 0,t?{border:"1px solid #ddd",boxShadow:"none"}:{},{paddingLeft:"0px",backgroundColor:e.palette.white,selectors:(i={},i["div#".concat("b_bfb-footerContent"," > a, div#").concat("b_bfb-footerContent"," > a:visited")]=[Object(O.n)(e),{display:"inline-block"}],i[".".concat("ms-search-scopeCardContent")]={marginBottom:"0px",borderBottom:"none"},i[".".concat(ei.a)]={paddingBottom:"0px",paddingTop:"".concat(hn.d-ei.c,"px"),selectors:(r={},r["div.".concat(ei.b,":last-child")]={borderBottom:"none"},r["> div:last-child .ms-search-buttonWithInfoBubble-info"]={top:"-50px"},r)},i[".".concat(tc)]={overflow:"hidden"},i[".".concat(ui.b,", .").concat(rc.c,",\n              .").concat(ic.a)]={paddingTop:"".concat(hn.d,"px")},i)}],contentRow:{marginLeft:"0px",selectors:(a={},a[".".concat(Kn.a)]={display:"none"},a[".".concat(ho.b)]={border:"none",borderRadius:0,maxWidth:"100%"},a)},header:{fontSize:"14px",lineHeight:"20px",marginLeft:"4px",marginBottom:"10px"}})})),oc=function(){var e=f.useState(!1),t=e[0],n=e[1],i=Object(k.a)(),r=Object(w.b)(),a=Object(p.a)(),o=Object(T.useSelector)(_.Sb),c=Object(T.useSelector)(Kr),l=Object(T.useSelector)(_.M),s=Object(T.useSelector)(Qr),u=Object(T.useSelector)((function(e){return Object(mt.c)(e)})),d="RightRail"===(u=u||"Pole"),b=Object(T.useSelector)((function(e){return Object(pt.c)(e,d)})),m=Object(T.useSelector)(mt.b),g=Object(T.useSelector)((function(e){return qr(e,d)})),v=H().isEnabled,h=Object(N.t)()&&"Low"===m&&v,O=Object(N.D)(),j=g||h||O&&"Low"==m,E=Object(bt.d)();if(f.useEffect((function(){!j||t||E||(Object(ye.o)(i,r),n(!0))}),[j,i,r,E]),!j)return st(u,void 0,m),null;lt(u,m);var x=ac(a,o,d),S=b?f.createElement("div",{className:x.header},b):void 0;return s?f.createElement(nc,null):f.createElement(f.Fragment,null,c?f.createElement(Rt,null):f.createElement(f.Fragment,null,S,f.createElement("div",{className:x.mainlineContainer},!l&&f.createElement(dt.a,null),f.createElement("div",{className:x.contentRow},f.createElement(nc,null)))))},cc=function(e){var t=e.query;return f.createElement(He.a,null,f.createElement(ot.a,{query:t,onCleanUp:st},f.createElement(oc,null),f.createElement(De.a,{codeLocation:"ScopeTabNotificationContainer.Bing"},f.createElement(rt,null))))},lc=n(1184),sc=n(1648),uc=n(1230),dc=n(1079),bc=n(1199),mc=n(1198),pc=n(933),fc=n(864),gc=n(870);var vc=Object(pa.a)("EnterpriseSubscription",(function(e,t){return Object(ln.__awaiter)(this,void 0,void 0,(function(){var n,i,r;return Object(ln.__generator)(this,(function(a){switch(a.label){case 0:return n=t.ResultCount,i=t.Filter,r=e.createRequestUrl("employee/subscription/all","v3",{ResultCount:"".concat(n),Filter:"".concat(i)}),[4,e.makeRequest(r,"GET",t)];case 1:return[2,a.sent()]}}))}))})),hc=Object(ba.c)("EnterpriseSubscriptionStore",vc),Oc=n(173);function jc(e,t){var n,i;if(t){var r=null==e?void 0:e.getElementsByClassName("b_algoheader")[0],a=null==r?void 0:r.getElementsByTagName("a")[0];return null==a?void 0:a.href}var o=null==e?void 0:e.getElementsByTagName("h2"),c=null===(n=null==o?void 0:o[0])||void 0===n?void 0:n.getElementsByTagName("a");return null===(i=null==c?void 0:c[0])||void 0===i?void 0:i.href}function Ec(e){if(e){var t="/"===e[e.length-1]?null==e?void 0:e.slice(0,-1):e;return null==t?void 0:t.replace(/^https?\:\/\//i,"")}return""}var xc=function(e){var t={};if(e){var n=document.querySelectorAll("li.b_algo"),i={};Object(Oc.a)(n,(function(e,t){var n=Ec(jc(e));n&&(i[n]=t)}));var r=Ec(jc(n[0])),a=Object(xt.a)(e,(function(e){return Ec(e.url)===r}));Object(Oc.a)(e,(function(e){if(e.url&&e.avgWeightedCTR&&e.avgWeightedSatScore&&!t.url){var r=Ec(null==e?void 0:e.url),o=i[r];if(0===o){if(c=n[o],u=null===(l=document.getElementById("b_results"))||void 0===l?void 0:l.firstElementChild,d=null==u?void 0:u.nextElementSibling,u!==c&&(0!==(null===(s=null==u?void 0:u.getBoundingClientRect())||void 0===s?void 0:s.height)||d!==c))return void(t=e)}else if(o>0){if(!(a&&a.avgWeightedCTR&&a.avgWeightedSatScore))return void(t=e);if((null==e?void 0:e.avgWeightedCTR)>(null==a?void 0:a.avgWeightedCTR)&&(null==e?void 0:e.avgWeightedSatScore)>(null==a?void 0:a.avgWeightedSatScore))return void(t=e)}}var c,l,s,u,d}))}return t};var Sc=Object(pa.a)("EnterpriseSuggestion",(function(e,t){return Object(ln.__awaiter)(this,void 0,void 0,(function(){var n,i;return Object(ln.__generator)(this,(function(r){switch(r.label){case 0:return n=e.createRequestUrl("enterprise/suggestions","v3"),[4,e.makeRequest(n,"POST",t)];case 1:return i=r.sent(),[2,xc(null==i?void 0:i.suggestions)]}}))}))})),Cc=Object(ba.c)("EnterpriseSuggestionStore",Sc);var yc=n(704),kc=n(551),wc=n(1460),Nc=n(2023),_c=n(1118),Lc=n(1119),Mc=n(1120),Tc=n(1122),Pc=n(1121),Ic=n(1123),Fc=n(1117),Ac=n(552),Rc=n(1075),Bc=n(202),Dc=n(932),Hc=n(2006),Wc=n(254),zc=function(){function e(){var e=this;this.isQFReady=!1;window.sj_evt.bind("msb:qf:rdy",(function t(){e.isQFReady=!0,Object(c.a)("QFReady Event fired"),window.sj_evt.unbind("msb:qf:rdy",t)}),!0,void 0,!0),this.qfDataProvider=window.BingAtWork}return e.prototype.getQueryFormulationSuggestions=function(){var e,t=null===(e=this.qfDataProvider)||void 0===e?void 0:e.getSuggestions;if(!t||!this.isQFReady)throw"getQueryFormulationSuggestions failed as window.BingAtWork.getSuggestions is undefined";var n=Object(Wc.g)("q");return n?new o.a((function(e,i){t(n,(function(t){e(t)}),(function(e){return i(e)}),{domains:["File"],count:10,scope:"MainlineQF"})})):o.a.resolve([])},e}(),qc=n(2007),Kc=n(2008),Qc=n(554),Uc=function(e,t,n,i){return new(n||(n=o.a))((function(r,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function c(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,c)}l((i=i.apply(e,t||[])).next())}))},Vc=function(e,t){var n,i,r,a,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof s.a&&(a[d.a]=function(){return this}),a;function c(c){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(o=0)),o;)try{if(n=1,i&&(r=2&c[0]?i.return:c[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,c[1])).done)return r;switch(i=0,r&&(c=[2&c[0],r.value]),c[0]){case 0:case 1:r=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,i=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!r||c[1]>r[0]&&c[1]<r[3])){o.label=c[1];break}if(6===c[0]&&o.label<r[1]){o.label=r[1],r=c;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(c);break}r[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(e){c=[6,e],i=0}finally{n=r=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}};function Gc(e){var t=e.reduxStore;if(t){var n,i,r=Object(Dc.a)(e),a=r.searchOptions,o=new zc,c=r.logger,l=Object(I.a)(a.msbApiVariants,"bfbqfmlflhc"),s=Object(I.a)(a.msbApiVariants,"bfbqfmlft1")?4e3:5e3;n=!1,i=setTimeout((function(){n=!0,t.dispatch(Object(qc.a)({isQFReady:!1,suggestionsFetchStatus:"Failed",suggestions:[]}))}),s),window.sj_evt.bind("msb:qf:rdy",(function(){return Jc(t,o,l,c,i,n)}),!0,void 0,!0)}}var Jc=function e(t,n,i,r,a,o){try{if(clearTimeout(a),o)return;t.dispatch(Object(qc.a)({isQFReady:!0,suggestionsFetchStatus:"Started",suggestions:[]}));var l=Object(Bc.a)(),s=function(e,t,n){return Uc(this,void 0,void 0,(function(){return Vc(this,(function(i){return[2,function(){return Object(Qc.k)(t,(function(){return e.getQueryFormulationSuggestions()}),"QueryFormulation_MainlineFileHero_RoundTripTime",!1,void 0,"File",n)}()]}))}))}(n,r,l);null==s||s.then((function(e){var n=i?Object(Kc.b)(e):e;if(n){var r="Mainline QF Suggestion Fetch  got ".concat(n.length," suggestions from qf");Object(c.a)(r),t.dispatch(Object(qc.a)({isQFReady:!0,suggestionsFetchStatus:"Complete",suggestions:n,traceId:l}))}else Object(c.a)("Mainline QF has no eligible suggestions")})).catch((function(e){Object(c.a)("Mainline QF Suggestion Fetch Promise failed with error ",e),t.dispatch(Object(qc.a)({isQFReady:!0,suggestionsFetchStatus:"Failed",suggestions:[]}))}))}catch(e){Object(c.a)("Mainline QF Suggestion Fetch Bind event failed with error ",e)}window.sj_evt.unbind("msb:qf:rdy",(function(){return e(t,n,i,r,a,o)}))};var Yc=n(1438),$c=n(1437),Xc=n(526);function Zc(){return{initialize:function(e){return function(e){var t=e.reduxStore,n=Object(Dc.a)(e),i=n.logger,r=n.searchOptions.isAjax;if(!t)return;var a=function(){window.sj_evt.bind("bfbMainlineRankingStarted",(function(){t.dispatch(Object(Yc.b)({isStartedEventFired:!0}))}),!0,void 0,!0),window.sj_evt.bind("bfbMainlineRankingSucceeded",(function(e){var n=e[1];Object(Xc.d)(i,n),t.dispatch(Object(Yc.c)({isSucceededEventFired:!0,ranking:n}))}),!0,void 0,!0),window.sj_evt.bind("bfbMainlineRankingFailed",(function(){Object(Xc.e)(i,"Failed"),t.dispatch(Object(Yc.a)({isFailedEventFired:!0}))}),!0,void 0,!0)};r?window.sj_evt.bind("ajax.load",(function(){a()})):a()}(e)},stores:[$c.a]}}var el,tl=n(220);!function(e){e[e.Unknown=-1]="Unknown",e[e.Published=0]="Published",e[e.Expired=1]="Expired",e[e.Draft=2]="Draft",e[e.Suggested=4]="Suggested"}(el||(el={}));function nl(e){return hc.getSelectors(e).hasError({key:"EnterpriseSubscription"})}function il(e){return hc.getSelectors(e).hasLoaded({key:"EnterpriseSubscription"})}function rl(e){return hc.getSelectors(e).isLoading({key:"EnterpriseSubscription"})}function al(e){var t,n,i=function(e){return hc.getSelectors(e).getLatestSuccess({key:"EnterpriseSubscription"})}(e);return(null==i?void 0:i.subscriptionList)&&(t=null==i?void 0:i.subscriptionList.subscription,n={},Object(Oc.a)(t,(function(e){var t=e.providerUrl.toLowerCase().replace("www.","");n[t]?n[t].push(e):n[t]=[e]})),n)}function ol(){var e=Object(ln.__read)(f.useState(!1),2),t=e[0],n=e[1],i=Object(tl.a)(rl,il,nl,al,(function(e){return function(e){var t=e.monitorStarter,n=e.msbRestProvider,i=e.logger,r={clientContext:Object(ma.g)(e),ResultCount:100,Filter:el.Published},a={monitorStarter:t,logger:i,rttName:"EnterpriseSubscription_RoundTripTime",msbRestProvider:n,fetchSoftTimeout:5e3};return Object(ba.a)(vc)(a,{key:"EnterpriseSubscription"},r)}(e)}),"FetchEnterpriseSubscription",Object(N.db)(),t?function(){return n(!1)}:void 0),r=Object(T.useSelector)((function(e){return function(e){return!Object(le.a)(al(e))}(e)}));return{subscriptionMap:i.data,isFetchingEnterpriseSubscription:i.isFetching,isFetchingEnterpriseSubscriptionFailed:i.isFetchFailed,hasFetchedEnterpriseSubscription:i.hasFetched,hasEnterpriseSubscription:r,retryRequests:function(){return n(!0)}}}function cl(e){return Cc.getSelectors(e).hasError({key:"EnterpriseSuggestion"})}function ll(e){return Cc.getSelectors(e).hasLoaded({key:"EnterpriseSuggestion"})}function sl(e){return Cc.getSelectors(e).isLoading({key:"EnterpriseSuggestion"})}function ul(e){return Cc.getSelectors(e).getLatestSuccess({key:"EnterpriseSuggestion"})}function dl(){var e=Object(ln.__read)(f.useState(!1),2),t=e[0],n=e[1],i=Object(tl.a)(sl,ll,cl,ul,(function(e){return function(e){var t,n=e.monitorStarter,i=e.msbRestProvider,r=e.logger,a=e.searchOptions,o={query:null===(t=null==a?void 0:a.initialSearchQuery)||void 0===t?void 0:t.query,clientContext:Object(ma.g)(e)},c={monitorStarter:n,logger:r,rttName:"EnterpriseSuggestion_RoundTripTime",msbRestProvider:i,fetchSoftTimeout:5e3};return Object(ba.a)(Sc)(c,{key:"EnterpriseSuggestion"},o)}(e)}),"FetchEnterpriseSuggestion",Object(N.gb)(),t?function(){return n(!1)}:void 0),r=Object(T.useSelector)((function(e){return function(e){return!Object(le.a)(ul(e))}(e)}));return{suggestion:i.data,isFetchingEnterpriseSuggestion:i.isFetching,isFetchingEnterpriseSuggestionFailed:i.isFetchFailed,hasFetchedEnterpriseSuggestion:i.hasFetched,hasEnterpriseSuggestion:r,retryRequests:function(){return n(!0)}}}var bl=n(219),ml=n(211);function pl(e){var t;if(!Object(pt.i)(e,"Person")){var n=null===(t=function(e){return{results:Object(pt.b)(e,"Person")}}(e))||void 0===t?void 0:t.results,i=Object(ml.f)(e);return i?Object(xt.a)(n,(function(e){return e.id===i})):Object(bl.a)(n)}}var fl=Object(ue.b)((function(e,t,n,i,r,a,o,c,l,s,u){var d,b=e.palette,m=b.neutralLighter,p=b.neutralSecondary,f=b.blueMid,g=b.white,v=b.black,h=n||f,j={content:"''",position:"absolute",width:i?"20.1px":"16.1px",height:i?"20.1px":"16.1px",borderRadius:i?"0 2px 2px 2px":"0 1px 2px 1px",transform:"rotate(-45deg) skew(10deg, 10deg)",background:"linear-gradient(-45deg, ".concat(f," 50%, transparent 50%)")};return Object(E.K)({popupHeader:{display:"flex",height:"48px",paddingLeft:"20px",backgroundColor:s?"none":h,borderTopLeftRadius:ve.a,borderTopRightRadius:ve.a},masthead:{maxWidth:"400px",selectors:(d={},d[".".concat("ms-search-tenantLogo")]={maxWidth:"360px"},d)},closeButton:{display:"inline-block",verticalAlign:"middle",float:"right",marginLeft:"auto",cursor:"pointer",marginRight:"18px",selectors:{i:{color:t}}},title:{marginTop:"15px",marginLeft:"20px",marginRight:"16px",fontSize:"15px",lineHeight:"18px",color:v},details:{marginTop:"12px",marginLeft:"20px",marginRight:"16px",fontSize:"13px",lineHeight:"18px",color:p,marginBottom:r?"":"20px"},anchorStyle:{marginTop:"8px",backgroundColor:"".concat(m," !important"),height:"64px"},primaryButton:{width:"157px",height:"32px",margin:"16px 41px 16px 42px",fontSize:"13px",backgroundColor:f,borderColor:f,selectors:{"&:hover, &:active":{backgroundColor:f,borderColor:f}}},popupContainer:{width:"240px",display:"flex",flexDirection:"column"},buttonContainer:[Object(he.j)(e),{selectors:{":hover":{color:e.palette.black}}},Object(he.r)(e),{display:"inline-block",height:"".concat(18,"px"),borderRadius:"2px",marginBottom:i?"20px":"0px",selectors:{"> button":{outline:"none",padding:"1px 0px 8px 0px"}}}],arrowButton:[Object(he.r)(e),{borderRadius:"2px 0px 0px 2px",fontSize:i?"14px":"11px",lineHeight:i?"18px":"14px",cursor:u?void 0:"pointer",color:g,fontWeight:"bold",position:"relative",display:"inline-flex",background:f,height:i?"18px":"14px",padding:i?"2.2px 2px 2px 8px":"2px 2px 2px 4px",alignItems:"center",selectors:{"&::after":[j,{right:i?"-9.1px":"-7.1px"}],"&::before":[j,{right:i?"-10.1px":"-8.1px"}]}}],tenantLabel:[Object(O.m)(e),{color:f,fontSize:i?"14px":"13px",lineHeight:i?"18px":"17px",cursor:u?void 0:"pointer",textDecoration:u?void 0:"underline",marginLeft:i?"20px":"15px"}],splitter:{marginLeft:"4px",marginRight:"4px"},bubbleContainer:{top:"".concat(o,"px !important"),left:"".concat(a,"px !important"),selectors:{"::after":{borderBottom:"".concat(8,"px solid ").concat(!s&&h," !important"),borderLeft:"".concat(8,"px solid transparent !important"),borderRight:"".concat(8,"px solid transparent !important")}}},customButton:{position:"relative",background:"none",border:"none"},infoBubble:{display:c||l?"block":"none"},bubbleWrapper:{position:"relative"}})})),gl=function(e){var t=e.id,n=e.decorationType,i=e.attachEventListener,r=Object(k.a)(),a=Object(w.b)();return f.useEffect((function(){"EnterpriseSuggestion"===n&&(Object(ye.h)(r,t,"Enterprise_Suggestion_Impression","AlgoDecoration",a),i&&i()),"LinkedInDecoration"===n&&(Object(ye.n)(r,t,"LinkedIn_AlgoDecoration_Impression","AlgoDecoration",a),i&&i())}),[r,a]),null},vl=n(2277),hl=function(e,t,n,i,r){if(t&&i&&e&&!r){var a=0,o=void 0;return Object(Oc.a)(i,(function(e){var t,i,r=e.providerUrl.toLowerCase().replace("www.",""),c=e.providerUrlRelativePath?(e.providerUrlRelativePath.startsWith("/")?"":"/")+e.providerUrlRelativePath.toLowerCase():"",l=null===(t=null==n?void 0:n.domain)||void 0===t?void 0:t.toLowerCase(),s=null===(i=null==n?void 0:n.relativeUrl)||void 0===i?void 0:i.toLowerCase(),u=r===l;if(u&&c.length>0&&(u=0===(null==s?void 0:s.indexOf(c))),u){var d=r.length+c.length;d>a&&(a=d,o=e)}})),o}},Ol=function(e,t,n,i,r){var a,o,c,l,s,u,d,b,m;if(t&&r&&e&&(null===(o=null===(a=null==n?void 0:n.domain)||void 0===a?void 0:a.toLowerCase())||void 0===o?void 0:o.includes("linkedin.com"))){var p=null===(s=null===(l=null===(c=e.getElementsByTagName("h2"))||void 0===c?void 0:c[0])||void 0===l?void 0:l.textContent)||void 0===s?void 0:s.toLowerCase(),f=null===(d=null===(u=e.getElementsByClassName("b_factrow b_twofr"))||void 0===u?void 0:u[0])||void 0===d?void 0:d.innerHTML.toLowerCase(),g={includeScore:!0,caseSensitive:!1,minMatchCharLength:3,threshold:.8,shouldSort:!0},v=[],h=[],O=null===(m=null===(b=e.getElementsByClassName("b_vlist2col"))||void 0===b?void 0:b[0])||void 0===m?void 0:m.getElementsByTagName("div");Object(Oc.a)(O,(function(e){var t,n,i,r,a,o,c,l=null==e?void 0:e.textContent,s=null===(n=null===(t=null==e?void 0:e.getElementsByTagName("strong"))||void 0===t?void 0:t[0])||void 0===n?void 0:n.textContent,u="Occupation:"===(null===(r=null===(i=null==e?void 0:e.getElementsByTagName("strong"))||void 0===i?void 0:i[0])||void 0===r?void 0:r.textContent)||"Title:"===(null===(o=null===(a=null==e?void 0:e.getElementsByTagName("strong"))||void 0===a?void 0:a[0])||void 0===o?void 0:o.textContent);if(l&&s&&u){var d=l.slice(s.length+1),b=null===(c=d.match(/\b[A-Z](?=[a-z])|, \b\w*/g))||void 0===c?void 0:c.join("");v.push(d),b&&h.push(b)}}));var j=new vl(v,g),E=new vl(h,g),x=Object(I.a)(p+f,i.toLowerCase()),S=Object(I.a)(p+f,r.fullName.toLowerCase()),C=!1;if(r.jobTitle&&x&&S){var y=j.search(r.jobTitle)[0],k=E.search(r.jobTitle)[0];y&&"string"!=typeof y?C=(null==y?void 0:y.score)<.5:k&&"string"!=typeof k&&(C=(null==k?void 0:k.score)<.7)}return x&&S&&C?r:void 0}};function jl(e,t){var n=null==e?void 0:e.getElementsByTagName("a")[0];return n.addEventListener("click",t),function(){n.removeEventListener("click",t)}}var El=n(2631),xl=n(1104),Sl=n(379),Cl=n(2567),yl=n(306),kl=(Object(Bn.declareString)("search-answer-decorator.search.algoDecoration.getAccess")),wl=(Object(Bn.declareString)("search-answer-decorator.search.algoDecoration.freeLabel")),Nl=(Object(Bn.declareString)("search-answer-decorator.search.algoDecoration.subscriptionMessage")),_l=(Object(Bn.declareStringWithPlaceholders)("search-answer-decorator.search.algoDecoration.trendingInEnterprise")),Ll=(Object(Bn.declareStringWithPlaceholders)("search-answer-decorator.search.algoDecoration.suggestionDescription")),Ml=(Object(Bn.declareString)("search-answer-decorator.search.algoDecoration.suggestionLabel")),Tl=(Object(Bn.declareString)("search-answer-decorator.search.algoDecoration.colleagueLabel")),Pl=(Object(Bn.declareString)("search-answer-decorator.search.algoDecoration.defaultTenantText")),Il=(Object(Bn.declareStringWithPlaceholders)("search-answer-decorator.search.algoDecoration.subscriptionForTenantLabel")),Fl=(Object(Bn.declareStringWithPlaceholders)("search-answer-decorator.search.algoDecoration.forTenantLabel")),Al=(Object(Bn.declareStringWithPlaceholders)("search-answer-decorator.search.algoDecoration.atTenantLabel")),Rl=(Object(Bn.declareStringWithPlaceholders)("search-answer-decorator.search.algoDecoration.atTenantLabelForSuggestions")),Bl=n(2646),Dl=function(e){var t=e.title,n=e.details,i=e.buttonText,r=e.setVisibility,a=e.setIsPopupFading,o=e.url,c=e.BrandMasthead,l=e.onClick,s=e.onClose,u=Object(p.a)(),d=Object(w.q)(),b=Object(Y.e)(),m=Object(T.useSelector)(_.M),g=Object(Y.b)(),v=fl(u,b,m?g:void 0,void 0,o,void 0,void 0,void 0,void 0,d);return f.createElement("div",{className:v.popupContainer},f.createElement("div",{className:v.popupHeader},f.createElement(c,{isPrivacyMessageEnabled:!1,className:v.masthead,selectedHeight:48}),f.createElement(xn.a,{iconName:"ChromeClose",onClick:function(){r&&r(!1),a&&a(!1),s&&s(!1)},className:v.closeButton})),f.createElement("div",{className:v.title}," ",t),f.createElement("div",{className:v.details}," ",n),o&&f.createElement("a",{href:o,target:"_blank",onClick:l?function(){return l()}:void 0,className:v.anchorStyle},f.createElement(Bl.a,{className:v.primaryButton,text:i,onClick:void 0})))},Hl=!1,Wl=!1,zl=function(e){var t=e.tenantName,n=e.algoItem,i=e.id,r=e.subscription,a=e.hasNoDecorationContent,o=e.onPopupButtonClick,c=e.logOnClick,l=e.logOnHover,s=e.logOnClose,u=e.BrandMasthead,d=e.bubbleClassName,b=e.attachEventListener,g=Object(ln.__read)(f.useState(!1),2),v=g[0],h=g[1],O=Object(ln.__read)(f.useState(!1),2),j=O[0],E=O[1],x=t&&t.length<18?t:Pl(),S=f.useRef(null),C=f.useRef(null),y=function(e){h(e),e||(Hl=!1)},N=function(e){E(e),Wl=e},L=f.useCallback((function(){var e=!Hl||!v;y(e),c&&c(e),Hl=e}),[y,Hl,v,c]),M=function(e){"Esc"!==e.key&&"Escape"!==e.key||y(!1)},P=f.useCallback((function(){Hl||v||Wl||W&&z||(l&&l(!0),N(!0),setTimeout((function(){l&&l(!1),N(!1)}),4e3))}),[Hl,N]);f.useEffect((function(){return window.addEventListener("keydown",M),function(){window.removeEventListener("keydown",M)}}),[]);var I=f.useCallback((function(){Hl||v||(y(!0),l&&l(!0))}),[Hl,y]),F=f.useCallback((function(e){var t,i,r,a;Hl||!v||Object(G.d)(null==e?void 0:e.relatedTarget,null===(t=null==n?void 0:n.getElementsByClassName("b_algo_bfb_deco_popup"))||void 0===t?void 0:t[0])||Object(G.d)(null==e?void 0:e.relatedTarget,null===(a=null===(r=null===(i=null==n?void 0:n.getElementsByClassName("b_algo_bfb_deco"))||void 0===i?void 0:i[0])||void 0===r?void 0:r.firstElementChild)||void 0===a?void 0:a.firstElementChild)||(y(!1),l&&l(!1))}),[Hl,y]);f.useEffect((function(){function e(e){v&&(e&&e.target&&S.current&&C.current&&(Object(G.d)(e.target,S.current)||Object(G.d)(e.target,C.current))||(y(!1),s&&s(!0),Hl=!1))}return document.addEventListener("mouseup",e),function(){document.removeEventListener("mouseup",e)}}),[S.current,C.current,v,y,Hl]);var A=Object(p.a)(),R=Object(Y.e)(),B=Object(k.a)(),D=Object(w.b)(),H=Object(w.c)(),W="Small"===D,z="Bing"===H,q=Object(Pi.e)(),K=Object(T.useSelector)(_.M),Q=Object(Y.b)(),U=W?100:50,V=fl(A,R,K?Q:void 0,void 0,void 0,void 0,void 0,v,j,void 0);if(f.useEffect((function(){r&&n&&(Object(ye.g)(B,i,"Enterprise_Subscription_Impression","AlgoDecoration",D),b())}),[B,D,q,r]),f.useEffect((function(){yl.render(f.createElement((function(){return f.createElement(Sl.a,null,(function(e){var t,n,i;return f.createElement(El.a,{context:e},f.createElement("div",{ref:C,className:V.bubbleWrapper},f.createElement(xl.a,{isSmall:W,className:Object(kn.a)(V.infoBubble,d),targetHeight:(null===(t=S.current)||void 0===t?void 0:t.offsetHeight)||void 0,targetWidth:(null===(n=S.current)||void 0===n?void 0:n.offsetWidth)?(null===(i=S.current)||void 0===i?void 0:i.offsetWidth)-U:void 0,isLeftAligned:!0,isTriangleAbsent:!1,noPadding:!0,onMouseEnter:I,onMouseLeave:F},function(e,t,n){return f.createElement(Dl,{setVisibility:t,setIsPopupFading:n,title:Il({tenant:x}),details:Nl(),buttonText:kl(),url:Object(Cl.c)(null==r?void 0:r.providerAccessHelpUrl)?null==r?void 0:r.providerAccessUrl:null==r?void 0:r.providerAccessHelpUrl,BrandMasthead:u,onClick:o,onClose:s})}(0,y,N))))}))}),null),null==n?void 0:n.getElementsByClassName("b_algo_bfb_deco_popup")[0])})),(null==n?void 0:n.getElementsByTagName("a")[0]).onmouseenter=P,r&&n){var J=f.createElement(f.Fragment,null,f.createElement("span",{className:V.arrowButton},wl()),f.createElement("span",{className:V.tenantLabel},Fl({tenant:x})));return f.createElement(f.Fragment,null,f.createElement("div",{ref:S,className:V.buttonContainer,role:"group",onMouseEnter:I,onMouseLeave:F},f.createElement("button",{"aria-expanded":v,tabIndex:0,onClick:L,onKeyPress:function(e){Object(m.o)(e,L)},"aria-label":wl(),className:V.customButton},J)),f.createElement(La.a,{className:V.splitter,isLarge:!0}))}return a(n),null},ql=!1,Kl=function(e){var t=e.tenantName,n=e.algoItem,i=e.id,r=e.hasNoDecorationContent,a=e.BrandMasthead,o=e.bubbleClassName,c=e.logOnClick,l=e.logOnHover,s=e.logOnClose,u=e.attachEventListener,d=Object(ln.__read)(f.useState(!1),2),b=d[0],g=d[1],v=t&&t.length<18?t:Pl(),h=f.useRef(null),O=f.useRef(null),j=function(e){g(e),e||(ql=!1)},E=f.useCallback((function(){var e=!ql||!b;j(e),c&&c(e),ql=e}),[j,ql,b,c]),x=function(e){"Esc"!==e.key&&"Escape"!==e.key||j(!1)};f.useEffect((function(){return window.addEventListener("keydown",x),function(){window.removeEventListener("keydown",x)}}),[]);var S=f.useCallback((function(){ql||b||(j(!0),l&&l(!0))}),[ql,j]),C=f.useCallback((function(e){var t,i,r,a;ql||!b||Object(G.d)(null==e?void 0:e.relatedTarget,null===(t=null==n?void 0:n.getElementsByClassName("b_algo_bfb_deco_popup"))||void 0===t?void 0:t[0])||Object(G.d)(null==e?void 0:e.relatedTarget,null===(a=null===(r=null===(i=null==n?void 0:n.getElementsByClassName("b_algo_bfb_deco"))||void 0===i?void 0:i[0])||void 0===r?void 0:r.firstElementChild)||void 0===a?void 0:a.firstElementChild)||(j(!1),l&&l(!1))}),[ql,j]);f.useEffect((function(){function e(e){b&&(e&&e.target&&h.current&&O.current&&(Object(G.d)(e.target,h.current)||Object(G.d)(e.target,O.current))||(j(!1),s&&s(!0),ql=!1))}return document.addEventListener("mouseup",e),function(){document.removeEventListener("mouseup",e)}}),[h.current,O.current,b,j,ql]);var y=Object(p.a)(),N=Object(Y.e)(),L=Object(k.a)(),M=Object(w.b)(),P=Object(Pi.e)(),I=Object(T.useSelector)(_.M),F=Object(Y.b)(),A="Small"===M?100:50,R=fl(y,N,I?F:void 0,!0,void 0,void 0,void 0,b);if(f.useEffect((function(){n&&(Object(ye.h)(L,i,"Enterprise_Suggestion_Impression","AlgoDecoration",M),u())}),[L,M,P]),f.useEffect((function(){yl.render(f.createElement((function(){return f.createElement(Sl.a,null,(function(e){var t,n,i,r;return f.createElement(El.a,{context:e},f.createElement("div",{ref:O,className:R.bubbleWrapper},f.createElement(xl.a,{isSmall:!1,className:Object(kn.a)(R.infoBubble,o),targetHeight:(null===(t=h.current)||void 0===t?void 0:t.offsetHeight)||void 0,targetWidth:(null===(n=h.current)||void 0===n?void 0:n.offsetWidth)?(null===(i=h.current)||void 0===i?void 0:i.offsetWidth)-A:void 0,isLeftAligned:!0,isTriangleAbsent:!1,noPadding:!0,onMouseEnter:S,onMouseLeave:C},(r=j,f.createElement(Dl,{setVisibility:r,title:_l({tenant:v}),details:Ll({tenant:v}),buttonText:kl(),BrandMasthead:a,onClose:s})))))}))}),null),null==n?void 0:n.getElementsByClassName("b_algo_bfb_deco_popup")[0])})),!n)return r(n),null;var B=f.createElement(f.Fragment,null,f.createElement("span",{className:R.arrowButton},Ml()),f.createElement("span",{className:R.tenantLabel},Rl({tenant:v})));return f.createElement(f.Fragment,null,f.createElement("div",{ref:h,className:R.buttonContainer,role:"group",onMouseEnter:S,onMouseLeave:C},f.createElement("button",{"aria-expanded":b,tabIndex:0,onClick:E,onKeyPress:function(e){Object(m.o)(e,E)},"aria-label":Ml(),className:R.customButton},B)))},Ql=function(e){var t=e.id,n=e.tenantName,i=e.attachEventListener,r=Object(p.a)(),a=Object(k.a)(),o=Object(w.b)(),c=Object(Y.e)(),l=Object(Pi.e)(),s=fl(r,c,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,!0);f.useEffect((function(){Object(ye.n)(a,t,"LinkedIn_AlgoDecoration_Impression","AlgoDecoration",o),i()}),[a,o,l]);var u=n&&n.length<18?n:Pl(),d=f.createElement(f.Fragment,null,f.createElement("span",{className:s.arrowButton},Tl()),f.createElement("span",{className:s.tenantLabel},Al({tenant:u})));return f.createElement(f.Fragment,null,f.createElement("div",{className:s.buttonContainer,role:"group"},f.createElement("div",{tabIndex:0,"aria-label":Tl(),className:s.customButton},d)),f.createElement(La.a,{className:s.splitter,isLarge:!0}))},Ul=function(e){var t,n,i,r,a,o=e.algoItem,c=e.index,l=e.hasNoDecorationContent,s=e.BrandMasthead,u=e.isCouponsOrRebatesDecorationEnabled,d=Object(J.d)(),b=Object(T.useSelector)((function(e){return pl(e)})),m=ol().subscriptionMap,g=dl().suggestion,v=Object(N.db)(),h=Object(N.gb)(),O=Object(N.h)(),j=Object(N.B)(),E=Object(N.C)(),x=Object(p.a)(),S=Object(Y.e)(),C=Object(w.q)(),y=Object(T.useSelector)(_.M),L=Object(Y.b)(),M=y?L:void 0,P=Object(k.a)(),I=Object(w.b)(),F="Small"===I,A=F?-1:18,R=Object(Pi.e)(),B=c.toString(),D=Object(ln.__read)(f.useState(!1),2),H=D[0],W=D[1];if(!v&&!h&&!E)return l(o),null;var z=function(e,t){var n=function(e,t){var n,i;if(t){var r=null==e?void 0:e.getElementsByClassName("b_algoheader")[0],a=null==r?void 0:r.getElementsByTagName("a")[0];return null==a?void 0:a.href}var o=null==e?void 0:e.getElementsByTagName("h2"),c=null===(n=null==o?void 0:o[0])||void 0===n?void 0:n.getElementsByTagName("a");return null===(i=null==c?void 0:c[0])||void 0===i?void 0:i.href}(e,t);if(n){var i,r="";try{r=new URL(n).hostname}catch(e){var a=n.split(/[/?#]/);r=n.indexOf("//")>-1?a[2]:a[0]}finally{i=r?r.split(":")[0].replace("www.",""):void 0;var o=n.substring(n.indexOf(r)+r.length);return{url:n,domain:i,relativeUrl:o}}}}(o,F);if(!z||!z.domain)return null;var q=m&&m[z.domain],K=function(e,t,n,i,r,a,o,c,l){var s=r&&hl(e,n,t,r,l);return s?{answer:s,eventScope:"EnterpriseSubscription"}:(Ec(t.url)===Ec(null==a?void 0:a.url)?a:void 0)?{eventScope:"EnterpriseSuggestion"}:Ol(e,i,t,c,o)?{eventScope:"LinkedInDecoration"}:void 0}(o,z,v,E,q,g,b,d,u);if(!K)return null;var Q=K.eventScope,U=null===(t=o.getElementsByTagName("p"))||void 0===t?void 0:t[0],V=null===(n=o.getElementsByClassName("b_algo_bfb_deco_popup"))||void 0===n?void 0:n[0],G=null===(i=o.getElementsByClassName("b_algo_bfb_deco"))||void 0===i?void 0:i[0];if(U.style.maxHeight="fit-content","EnterpriseSuggestion"===Q&&!H){var $=null===(r=o.getElementsByClassName("b_caption"))||void 0===r?void 0:r[0];null===(a=$.parentNode)||void 0===a||a.insertBefore(G,$.nextSibling),W(!0)}u&&(U.style.display="inline");var X=G.getBoundingClientRect().left-V.getBoundingClientRect().left+A,Z=G.getBoundingClientRect().top-V.getBoundingClientRect().top+28,ee=fl(x,S,M,void 0,void 0,X,Z,void 0,void 0,C),te=function(){!function(e,t,n,i,r){var a={cardType:"AlgoDecoration",clientSize:t,eventScope:n,traceId:i,target:r};Object(Pt.l)(e,{eventId:"Algo_Decoration_Url_Click",properties:a})}(P,I,Q,R,B)},ne={tenantName:d,algoItem:o,id:B,hasNoDecorationContent:l,BrandMasthead:s,bubbleClassName:ee.bubbleContainer,logOnClick:function(e){return function(e,t,n,i,r,a){var o=a?"Algo_Decoration_Popup_Open_BannerClick":"Algo_Decoration_Popup_Close_BannerClick",c={cardType:"AlgoDecoration",clientSize:t,eventScope:n,traceId:i,target:r};Object(Pt.l)(e,{eventId:o,properties:c})}(P,I,Q,R,B,e)},logOnHover:function(e){return function(e,t,n,i,r,a){var o=a?"Algo_Decoration_Popup_Open_Hover":"Algo_Decoration_Popup_Close_Hover",c={cardType:"AlgoDecoration",clientSize:t,eventScope:n,traceId:i,target:r};Object(Pt.l)(e,{eventId:o,properties:c})}(P,I,Q,R,B,e)},logOnClose:function(e){return function(e,t,n,i,r,a){var o=a?"Algo_Decoration_Popup_Close_ExternalClick":"Algo_Decoration_Popup_Close_CloseButtonClick",c={cardType:"AlgoDecoration",clientSize:t,eventScope:n,traceId:i,target:r};Object(Pt.l)(e,{eventId:o,properties:c})}(P,I,Q,R,B,e)},attachEventListener:function(){return jl(o,te)}};switch(Q){case"EnterpriseSubscription":return f.createElement(zl,Object(ln.__assign)({},ne,{subscription:K.answer,onPopupButtonClick:function(){!function(e,t,n,i,r){var a={cardType:"AlgoDecoration",clientSize:t,eventScope:n,traceId:i,target:r};Object(Pt.l)(e,{eventId:"Algo_Decoration_Popup_GetAccessClick",properties:a})}(P,I,Q,R,B)}}));case"LinkedInDecoration":return j?f.createElement(gl,{id:B,decorationType:"LinkedInDecoration",attachEventListener:function(){return jl(o,te)}}):f.createElement(Ql,{id:B,tenantName:d,attachEventListener:function(){return jl(o,te)}});case"EnterpriseSuggestion":return O?f.createElement(gl,{id:B,decorationType:"EnterpriseSuggestion",attachEventListener:function(){return jl(o,te)}}):f.createElement(Kl,Object(ln.__assign)({},ne));default:return null}};var Vl=function(e){var t=null==e?void 0:e.getElementsByClassName("b_attribution")[0],n=null==e?void 0:e.getElementsByClassName("b_deco")[0];if(n&&t){yl.unmountComponentAtNode(n);try{t.removeChild(n)}catch(e){Object(c.b)(e)}}};function Gl(){var e=document.querySelectorAll("li.b_algo");Object(Oc.a)(e,(function(e,t){!function(e,t){var n,i,r,a=null===(n=e.getElementsByTagName("p"))||void 0===n?void 0:n[0];if(a){var o=document.createElement("span");o.className="b_algo_bfb_deco";var c=document.createElement("div");c.className="b_algo_bfb_deco_popup",e.insertBefore(c,e.childNodes[0]),a.insertBefore(o,a.childNodes[0]);var l=a.firstElementChild,s=!(!(null===(i=e.getElementsByClassName("cp_anno"))||void 0===i?void 0:i[0])&&!(null===(r=e.getElementsByClassName("rebateContainer"))||void 0===r?void 0:r[0]));null!==l&&yl.render(f.createElement(He.a,null,f.createElement(Ul,{algoItem:e,index:t,hasNoDecorationContent:Vl,BrandMasthead:ro.a,isCouponsOrRebatesDecorationEnabled:s})),l)}}(e,t)}))}var Jl=n(1331),Yl=n(1206),$l=n(637),Xl=n(638),Zl=function(e,t,n,i){return new(n||(n=o.a))((function(r,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function c(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,c)}l((i=i.apply(e,t||[])).next())}))};function es(){return Zl(this,void 0,void 0,r.a.mark((function e(){var t,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Jn.a.startMSBAnswerProfiling(),t={all:{prefetch:$l.u},isMainlineQFFileHeroEnabled:Object(Xl.K)()},i=t,n={reduxExtensions:Object(fc.a)({stores:[wc.b,Nc.a,kc.b,Ac.c,yc.b]},Object(Rc.a)(),Zc(),(null==i?void 0:i.isMainlineQFFileHeroEnabled)?{initialize:Gc,stores:[Hc.a]}:void 0,Object(gc.b)(null==i?void 0:i.all),{stores:[Cc,hc]}),searchEntityPlugins:{Message:Object(dc.a)(),People:Object(bc.a)(),EnterpriseLearning:{entityType:"EnterpriseLearning",components:{},redux:{selectors:{getResults:ca},actionCreators:{fetchResults:ha},stores:[va]}},Event:Object(uc.a)(),MeetingRoomProposal:Object(uc.b)(),Acronym:Object(lc.a)(),Topic:Object(mc.b)(),TuringQnA:Object(pc.a)()},restUtilPlugins:{PersonPhoto:Object(Fc.a)(),FloorPlan:Object(_c.a)(),GroupMembers:Object(Lc.a)(),GroupPhoto:Object(Mc.a)(),PersonGroups:Object(Pc.a)(),PersonCalendar:Object(Tc.a)(),PersonListDetails:Object(Ic.a)(),AssignmentInfo:Object(sc.a)()}},e.next=5,Object(Yl.a)(ns,"Serp",n);case 5:if(is(),!Object(Xl.M)()){e.next=9;break}return e.next=9,ts();case 9:case"end":return e.stop()}var i}),e)})))}function ts(){return Zl(this,void 0,void 0,r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Xl.E)();case 2:t=e.sent,Object(Xl.I)()?t?yl.render(f.createElement(ze,null),t):Object(c.a)("BingAtWork context region answer was not placed"):Object(c.a)("BingAtWork context region component disabled on non-1st page");case 4:case"end":return e.stop()}}),e)})))}function ns(e,t){return Zl(this,void 0,void 0,r.a.mark((function n(){var i,a;return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(Object(Xl.I)()){n.next=3;break}return Object(c.a)("BingAtWork component disabled on non-1st page"),n.abrupt("return");case 3:if(e){n.next=6;break}return n.abrupt("return");case 6:return i=new Error("MSB: root element was not found for MainlineInitializer"),n.next=9,Object(Xl.p)(t,i);case 9:if(a=n.sent){n.next=13;break}throw st(void 0,!1),i;case 13:yl.render(f.createElement(cc,{query:e}),a),Object(Xl.h)()&&Gl();case 15:case"end":return n.stop()}}),n)})))}function is(){var e=this;Object(Jl.a)((function(t,n,i,a){return Zl(e,void 0,void 0,r.a.mark((function e(){var i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(c.a)("handleAjaxSerp on mainline",{eventName:t,relativeUrl:n,isPersistentAjaxRequest:a}),"ajax.load"!==t||!a){e.next=8;break}return Object(c.a)("handleAjaxSerp on mainline, processing persistent ajax"),i=new Error("MSB: root element was not found for MainlineInitializer's prepareAjaxSerp"),e.next=6,Object(Xl.p)(Yl.b,i);case 6:e.sent&&Object(c.a)("handleAjaxSerp on mainline, setting up mainline features");case 8:case"end":return e.stop()}}),e)})))}))}},952:function(e,t,n){"use strict";n.d(t,"d",(function(){return d})),n.d(t,"c",(function(){return b})),n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return p}));var i=n(1078),r=n(376),a=n(509),o=Object(r.a)((function(e,t){return Object(a.a)(e)?Object(i.a)(e,t):[]})),c=n(1221),l=n(510),s=n(458),u=n(478);function d(e){var t;if(e.classList)null===(t=e.classList)||void 0===t||t.remove("bw-ScopeItemHide");else{var n=Object(c.a)(e.getAttribute("class")||""," ");e.setAttribute("class",Object(l.a)(o(n,"bw-ScopeItemHide")," "))}}function b(e){return e.classList?e.classList.contains("bw-ScopeItemHide"):Object(c.a)(e.getAttribute("class")||""," ").indexOf("bw-ScopeItemHide")>0}function m(e){switch(e){case"BookmarkCampaign":return u.b;case"AdminCampaign":return u.a;default:return u.e}}function p(e){switch(e){case"Acronym":return"Acronym";case"Conversation":return"Conversation";case"File":return"File";case"Building":return"Buildings";case"Site":return"Site";case"FloorPlan":return"FloorPlan";case"Person":return"Person";case"Privacy":case"Customization":case"Organization":case"Qna":case"WorkVertical":case"PersonConnect":case"PersonLearn":case"PersonMeet":case"School":case"Assignment":case"Class":case"BookmarkAnswers":case"BookmarkDiscover":case"BookmarkLocate":case"WorkForAdmin":return"None";default:return Object(s.b)(e,"None")}}}}]);